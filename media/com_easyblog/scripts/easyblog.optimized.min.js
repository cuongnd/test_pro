FD31.installer("EasyBlog","definitions",function(q){q.module("easyblog/admin easyblog/dashboard easyblog/dashboard/blogimage easyblog/dashboard/editor easyblog/dashboard/medialink easyblog/easyblog easyblog/layout/responsive easyblog/layout/lightbox easyblog/legacy easyblog/featured easyblog/location easyblog/media easyblog/media/navigation easyblog/media/uploader easyblog/media/browser easyblog/media/browser.item easyblog/media/editor easyblog/ easyblog/media/constrain easyblog/media/editor.audio easyblog/media/editor.file easyblog/media/editor.image easyblog/media/editor.video easyblog/media/uploader.item easyblog/ratings easyblog/tag".split(" "));
q.require.template.loader("easyblog/media/recent.item easyblog/media/browser easyblog/media/browser.item-group easyblog/media/browser.item easyblog/media/browser.tree-item-group easyblog/media/browser.tree-item easyblog/media/browser.pagination-page easyblog/media/browser.uploader easyblog/media/browser.uploader.item easyblog/media/editor easyblog/media/editor.viewport easyblog/media/navigation.item easyblog/media/navigation.itemgroup easyblog/media/editor.audio easyblog/media/editor.audio.player easyblog/media/editor.file easyblog/media/editor.file.preview easyblog/media/editor.image easyblog/media/editor.image.variation easyblog/media/editor.image.caption easyblog/media/editor.video easyblog/media/editor.video.player easyblog/dashboard/dashboard.tags.item".split(" "));
q.require.language.loader("COM_EASYBLOG_MM_UNABLE_TO_FIND_EXPORTER COM_EASYBLOG_MM_GETTING_IMAGE_SIZES COM_EASYBLOG_MM_UNABLE_TO_RETRIEVE_VARIATIONS COM_EASYBLOG_MM_ITEM_INSERTED COM_EASYBLOG_MM_UPLOADING COM_EASYBLOG_MM_UPLOADING_STATE COM_EASYBLOG_MM_UPLOADING_PENDING COM_EASYBLOG_MM_UPLOAD_COMPLETE COM_EASYBLOG_MM_UPLOAD_PREPARING COM_EASYBLOG_MM_UPLOAD_UNABLE_PARSE_RESPONSE COM_EASYBLOG_MM_UPLOADING_LEFT COM_EASYBLOG_MM_CONFIRM_DELETE_ITEM COM_EASYBLOG_MM_CANCEL_BUTTON COM_EASYBLOG_MM_YES_BUTTON COM_EASYBLOG_MM_ITEM_DELETE_CONFIRMATION".split(" "))});
FD31.installer("EasyBlog","scripts",function(q){EasyBlog.module("admin",function(c){var h=window.admin={blog:{reject:function(a){ejax.load("Pending","confirmRejectBlog",a)},approve:function(a,b){confirm(b)&&(window.location=eblog_site+"&c=blogs&task=approveBlog&cid[]="+a)}},settings:{importSettings:function(){ejax.load("settings","import")}},checkbox:{init:function(){c(".option-enable").click(function(){var a=c(this).parent();c(".option-disable",a).removeClass("selected");c(this).addClass("selected");
c(".radiobox",a).attr("value",1)});c(".option-disable").click(function(){var a=c(this).parent();c(".option-enable",a).removeClass("selected");c(this).addClass("selected");c(".radiobox",a).attr("value",0)})}},pending:{reject:function(){}},spools:{preview:function(a){ejax.load("Spools","preview",a)}},teamblog:{markAdmin:function(a,b){window.location=eblog_site+"&c=teamblogs&task=markAdmin&teamid="+a+"&userid="+b},removeAdmin:function(a,b){window.location=eblog_site+"&c=teamblogs&task=removeAdmin&teamid="+
a+"&userid="+b}}};c(function(){var a=c("#submenu").attr("class");0<c("#submenu li").eq(4).length&&"settings"!=a&&ejax.load("Easyblog","appendPending");0<c("#system-message").length&&0==c(".eb-bootstrap").length&&(a=c("#system-message").html(),c("#system-message").remove(),c('<dl id="system-message">'+a+"</dl>").insertAfter("#toolbar-box"));c("body #settingsForm .admintable tr:odd").addClass("tr-odd");c(".admintable tr").hover(function(){c(this).addClass("tr-hover")},function(){c(this).removeClass("tr-hover")});
h.checkbox.init()});this.resolve()});EasyBlog.module("dashboard",function(c){EasyBlog.Controller("Dashboard",{defaultOptions:function(){}},function(c){return{init:function(){EasyBlog.dashboard=c},registerPlugin:function(a,b){void 0===c[a]&&(c[a]=b)}}});this.resolve()});EasyBlog.module("dashboard/blogimage",function(c){var h=this;EasyBlog.require().library("image").done(function(){EasyBlog.Controller("Dashboard.BlogImage",{defaultOptions:{"{placeHolder}":".blogImagePlaceHolder","{imageData}":".imageData",
"{image}":".image","{selectBlogImageButton}":".selectBlogImage","{removeBlogImageButton}":".removeBlogImage"}},function(a){return{init:function(){EasyBlog.dashboard.registerPlugin("blogImage",a);var b=c.trim(a.imageData().val());b&&a.setImage(c.parseJSON(b))},"{selectBlogImageButton} click":function(){EasyBlog.mediaManager.browse(null,"blogimage")},"{removeBlogImageButton} click":function(b){a.removeImage();b.blur()},removeImage:function(){a.image().remove();a.element.addClass("empty");a.imageData().val("")},
setImage:function(b){b&&(a.removeImage(),a.element.addClass("loading"),clearTimeout(a.imageTimer),b=c.extend({},b),delete b.data,c.Image.get(b.thumbnail.url).done(function(e){var f=function(){var b=a.placeHolder();maxWidth=b.width();maxHeight=b.height();b=c.Image.resizeWithin(e.data("width"),e.data("height"),maxWidth,maxHeight);b.top=(maxHeight-b.height)/2;b.left=(maxWidth-b.width)/2;return b},g=f(),d=function(){0===g.width||0===g.height?a.imageTimer=setTimeout(function(){g=f();d()},1E3):e.css(g)};
d();e.addClass("image").css(g).appendTo(a.placeHolder());a.imageData().val(JSON.stringify(b));a.element.removeClass("empty")}).fail(function(){a.element.addClass("empty")}).always(function(){a.element.removeClass("loading")}))}}});h.resolve()})});EasyBlog.module("dashboard/editor",function(c){EasyBlog.Controller("Dashboard.Editor",{defaultOptions:{editorId:"write_content"}},function(c){return{init:function(){EasyBlog.dashboard.registerPlugin("editor",c)},insert:function(a){window.jInsertEditorText(a,
c.options.editorId)},content:function(a){void 0!==a&&window.eblog.editor.setContent(a);return window.eblog.editor.getContent()}}});this.resolve()});EasyBlog.module("dashboard/medialink",function(c){EasyBlog.Controller("Dashboard.MediaLink",{defaultOptions:{"{menu}":".ui-togmenu","{content}":".ui-togbox"}},function(c){return{init:function(){},"{menu} click":function(a){var b=a.hasClass("active");c.menu().removeClass("active");c.content().removeClass("active");b||(a.addClass("active"),c.content("."+
a.attr("togbox")).addClass("active"))}}});this.resolve()});EasyBlog.require().library("ui/position","fancybox","bookmarklet","checked","checkList").script("layout/responsive","layout/lightbox","legacy").done();EasyBlog.module("layout/responsive",function(c){EasyBlog.options.responsive&&c(function(){c("#eblog-wrapper").responsive([{at:818,switchTo:"w768"},{at:600,switchTo:"w768 w600"},{at:500,switchTo:"w768 w600 w320"}])});this.resolve()});EasyBlog.module("layout/lightbox",function(c){EasyBlog.require().script("legacy").done(function(){if(window.eblog_enable_lightbox){var c=
{showOverlay:!0,centerOnScroll:!0,overlayOpacity:0.7};window.eblog_lightbox_title||(c.helpers={title:!1});window.eblog_lightbox_enforce_size&&(c.maxWidth=window.eblog_lightbox_width,c.maxHeight=window.eblog_lightbox_height);eblog.images.initFancybox("a.easyblog-thumb-preview",c)}eblog.images.initCaption("img.easyblog-image-caption")})});EasyBlog.module("legacy",function(c){window.isSave=!1;var h=window.eblog={stream:{load:function(b){a.load("dashboard","loadStream",b)}},login:{toggle:function(){c("#easyblog-search-form").hide().siblings().removeClass("active");
c(".user-options").hide().siblings().removeClass("active");c("#easyblog-login-form").toggle();c("#easyblog-login-form").siblings().toggleClass("active")}},report:{show:function(b,c){EasyBlog.ajax("site.views.reports.show",{id:b,type:c},function(b,g){a.dialog({title:b,content:g})})}},search:{toggle:function(){c(".user-options").hide().siblings().removeClass("active");c("#easyblog-login-form").hide().siblings().removeClass("active");c("#easyblog-search-form").toggle();c("#easyblog-search-form").siblings().toggleClass("active")}},
toolbar:{dashboard:function(){c("#easyblog-search-form").hide();c("#easyblog-login-form").hide();c(".user-options").toggle();c(".user-options").siblings().toggleClass("active")}},images:{initFancybox:function(a,e){window.eblog_lightbox_strip_extension&&window.eblog_lightbox_title?c(a).each(function(){var a=c(this),b=a.attr("title")||"",b=b.split(".").reverse();/jpg|png|gif|xcf|odg|bmp|jpeg/.test(b[0].toLowerCase())&&b.splice(0,1);b=b.reverse().join(".");a.fancybox(c.extend(!0,{},e,{title:b}))}):c(a).fancybox(e)},
initCaption:function(a){c(a).each(function(a,b){b=c(b).removeClass("easyblog-image-caption");if(!(0<b.parents(".easyblog-image-caption-container").length)){var g=c(b).attr("src"),d=b.parent().hasClass("easyblog-thumb-preview"),l=function(a){a=a[0];var b=!1;c.each(a.parentNode.childNodes,function(d,g){g==a||c(g).hasClass("easyblog-image-caption")||c(g).hasClass("easyblog-thumb-preview")||(b=!0)});return b};b.one("load",function(){var a=d?b.parent():b,g=a.css("float");"none"==g&&(g=b.css("float"));
if("none"==g){var e=(b.attr("style")||"").split(";"),h={};c.each(e,function(a,b){var d=b.split(":");h[c.trim(d[0])]=c.trim(d[1])});"auto"==h["margin-left"]&&"auto"==h["margin-right"]&&(g="center")}if("none"==g){e=b.parent().attr("align");if(void 0===e||"none"==e)e=b.attr("align");switch(e){case "left":g="left";break;case "right":g="right";break;case "center":case "middle":g="center"}}/none|center/.test(g)||(g=(l(a)?"float":"align")+g);e=c("<span>").addClass("easyblog-image-caption-container orientation-"+
g);"center"==g||"alignright"==g||"alignleft"==g?(g=c("<span>"),a.wrap(g),a.parent().wrap(e)):a.wrap(e);g=c("<span>").addClass("easyblog-image-caption");g.width(a.outerWidth()).html(b.attr("title"));a.after(g)}).removeAttr("src").attr("src",g)}})}},captcha:{reload:function(){var b=c("#captcha-id").val();a.load("entry","reloadCaptcha",b)},reloadImage:function(a,e){c("#captcha-image").attr("src",e);c("#captcha-id").val(a);c("#captcha-response").val("")}},comments:{edit:function(b){a.load("entry","editComment",
b)},remove:function(b){a.load("entry","deleteComment",b)}},checkbox:{render:function(){c(".option-enable").click(function(){var a=c(this).parent();c(".option-disable",a).removeClass("selected");c(this).addClass("selected");c(".radiobox",a).attr("value",1)});c(".option-disable").click(function(){var a=c(this).parent();c(".option-enable",a).removeClass("selected");c(this).addClass("selected");c(".radiobox",a).attr("value",0)})}},categories:{loadMore:function(a){c(a).parent().hide().next(".more-subcategories").show()}},
drafts:{getContent:null,frequency:15E3,chars:0,check:function(){var b=h.drafts.getContent();if("undefined"!=typeof b){var e=c("#title").val();(0<b.length||0<e.length&&e!=emptyText)&&a.load("dashboard","saveDraft",a.getFormVal("#blogForm"),b,"");setTimeout("eblog.drafts.check()",h.drafts.frequency)}},save:function(){h.editor.toggleSave();c(window).unbind("beforeunload");c("#form-task").val("savedraft");var a=h.editor.getContent(),a=c("<div>").html(a).html();c("#write_content_hidden").val(a);c("#blogForm").submit()}},
subscription:{show:function(b,c){a.load("subscription","showForm",b,c)},submit:function(b){h.loader.loading("eblog_loader");a.load("subscription","submitForm",b,a.getFormVal("#frmSubscribe"))}},dashboard:{logout:function(){c("#eblog-logout").submit()},changeCollab:function(a){c("#blog_contribute_source").val(a)},changeAuthor:function(b,e){a.dialog({width:700,height:500,title:b,content:"",beforeDisplay:function(){c(this).find(".dialog-middle").css("padding",0)},afterDisplay:function(){var a=c(this);
c("<iframe>").attr("src",e).css({width:a.find(".dialog-middle").width(),height:a.find(".dialog-middle").height(),border:"none"}).appendTo(a.find(".dialog-middle-content"))}})},changeCategory:function(b,e){a.dialog({width:700,height:500,title:b,content:"",beforeDisplay:function(){c(this).find(".dialog-middle").css("padding",0)},afterDisplay:function(){var a=c(this);c("<iframe>").attr("src",e).css({width:a.find(".dialog-middle").width(),height:a.find(".dialog-middle").height(),border:"none"}).appendTo(a.find(".dialog-middle-content"))}})},
socialshare:{setActive:function(a){c(a).parent().toggleClass("active")}},drafts:{discard:function(b){a.load("dashboard","confirmDeleteDraft",b)},discardAll:function(){a.load("dashboard","confirmDeleteAllDraft")}},lists:{init:function(a){c("#dashboard-"+a).checkList({checkbox:".stackSelect",masterCheckbox:".stackSelectAll",check:function(){this.parent(".ui-list-select").addClass("active");c("#select-actions").show()},uncheck:function(){this.parent(".ui-list-select").removeClass("active");c("#select-actions").hide()},
change:function(a,b){}})}},toggle:function(a){"block"==c(a).parent().next().css("display")?(c(a).parent().addClass("ui-togbox"),c(a).parent().next().hide()):(c(a).parent().removeClass("ui-togbox"),c(a).parent().next().show())},quickpost:{notify:function(a,e){c("#eblog-message").removeClass("error info success").addClass(a);c("#eblog-message div").html(e);c("#eblog-message").show()},save:function(){h.loader.loading("quickpost-loading");var b=a.getFormVal("#quick-post");a.load("dashboard","save",b)},
draft:function(){h.loader.loading("quickdraft-loading");var b=c("#eblog-post-content").val();a.load("dashboard","quickSaveDraft",a.getFormVal("#quick-post"),b,"")}},settings:{submit:function(){if((""!=c("#password").val()||""!=c("#password2").val())&&c("#password").val()!=c("#password2").val())return c(".password-notice").show(),!1;c("#dashboard").submit()}},categories:{create:function(){"block"==c("#widget-create-category").css("display")?c("#widget-create-category").slideUp():c("#widget-create-category").slideDown();
return!1},edit:function(b){a.load("dashboard","editCategory",b)},remove:function(b,c){a.load("dashboard","confirmDeleteCategory",c,b)},quicksave:function(b){a.load("dashboard","quickSaveCategory",b)}},comments:{publish:function(b,c){a.load("dashboard","publishComment",b,c)},publishModerated:function(b,c){a.load("dashboard","publishModerateComment",b,c)},edit:function(b){a.load("dashboard","editComment",b)},remove:function(b,c){a.load("dashboard","confirmDeleteComment",c,b)}},action:function(b,e){var f=
c("#"+b+"-action").val(),g="";c("#"+b+'-form INPUT[name="cid[]"]').each(function(){c(this).attr("checked")&&(g=0==g.length?c(this).val():g+","+c(this).val())});if(""==g)h.system.alert("COM_EASYBLOG_PLEASE_SELECT_ONE_ITEM_TO_CONTINUE","COM_EASYBLOG_WARNING");else switch(f){case "copy":a.load("dashboard","copyForm",g);break;case "discardDraft":h.dashboard.drafts.discard(g);break;case "publishBlog":h.blog.togglePublish(g,"publish");break;case "unpublishBlog":h.blog.togglePublish(g,"unpublish");break;
case "deleteBlog":h.blog.confirmDelete(g,e);break;case "rejectBlog":h.editor.reject(g);break;case "unpublishComment":h.dashboard.comments.publish(g,"unpublish");break;case "publishComment":h.dashboard.comments.publish(g,"publish");break;case "removeComment":h.dashboard.comments.remove(e,g,"");break;default:h.system.alert("COM_EASYBLOG_PLEASE_SELECT_ACTION_TO_PERFORM","COM_EASYBLOG_WARNING")}},videos:{insert:function(b){var e=c("#video-source").val(),f=c("#video-width").val(),g=c("#video-height").val();
jInsertEditorText('[embed=videolink]{"video":"'+e+'","width":"'+f+'","height":"'+g+'"}[/embed]',b);a.closedlg()},showForm:function(b){try{IeCursorFix()}catch(c){}a.load("dashboard","showVideoForm",b)}},preview:function(b){var e=h.drafts.getContent();if("undefined"!=typeof e){var f=c("#eblog-wrapper #title").val();0<e.length&&0<f.length&&f!=emptyText?a.call("dashboard","saveDraft",[a.getFormVal("#blogForm"),e,""],{success:function(){var a=c("#draft_id").val();if(""!=a){var d=screen.width,l=screen.height;
window.open(c.rootPath+"index.php?option=com_easyblog&view=entry&layout=preview&draftid="+a+"&Itemid="+b,"","toolbar=no, location=no, directories=no, status=yes, menubar=yes, scrollbars=yes, resizable=yes, copyhistory=no, width="+d+", height="+l+", top="+(screen.height/2-l/2)+", left="+(screen.width/2-d/2))}}}):0<e.length?h.system.alert("COM_EASYBLOG_PLEASE_SET_TITLE_BEFORE_PREVIEW","COM_EASYBLOG_ENTRY_PREVIEW_MODE"):h.system.alert("COM_EASYBLOG_ENTRY_PREVIEW_MODE_NO_CONTENT","COM_EASYBLOG_ENTRY_PREVIEW_MODE")}}},
editor:{checkPublishStatus:function(){var b=c("#published").val(),e=c("#publish_down").val();if(""==e||"0000-00-00 00:00:00"==e)return h.editor.postSubmit(),!0;a.load("dashboard","checkPublishStatus",b,e);return!0},cancelSubmit:function(){isSave=!1;c("#save_post").attr("disabled","");return!1},postSubmit:function(){c(window).unbind("beforeunload");c("#blogForm").submit()},save:function(){h.editor.toggleSave();var a=h.editor.getContent(),e=a.split('<hr id="system-readmore" />');1<e.length?(a=c.sanitizeHTML(e[0]),
e=c.sanitizeHTML(e[1]),e=a+'<hr id="system-readmore" />'+e):e=c.sanitizeHTML(a);c("#write_content_hidden").val(e);c("#save_post_button").addClass("ui-disabled");c("#save_post_button").attr("disabled","disabled");h.editor.checkPublishStatus()},apply:function(){c("input[name=apply]").val(1);h.editor.save()},reject:function(b){a.load("Dashboard","confirmRejectBlog",b)},search:{load:function(){try{IeCursorFix()}catch(b){}a.load("search","search",c("#search-content").val())},insert:function(a,e,f){a='<a href="'+
a+'">'+e+"</a>";switch(f){case "intro":c("#widget-write-introtext .ui-modhead").hasClass("ui-togbox")?h.editor.setIntro(a):jInsertEditorText(a,f);break;case "write_content":c("#widget-writepost .ui-modhead").hasClass("ui-togbox")?h.editor.setContent(a):jInsertEditorText(a,f)}}},setIntro:null,setContent:null,getContent:null,datetimepicker:{element:function(a,e){c("#datetime_"+a).addClass("toggle-active");c("#datetime_edit_"+a).hide();var f,g,d,l,m,n;h.editor.datetimepicker.hideEditLink(a);h.editor.datetimepicker.hideEditLink(a);
"publish_down"==a&&""==c("#"+a).val()&&(f=c("#publish_down_reset").val(),c("#"+a).val(f));""!=c("#"+a).val()?(f=c("#"+a).val().split(" "),m=f[1].split(":"),d=f[0].split("-"),f=d[2],g=d[1],d=d[0],l=m[0],m=m[1]):(today=new Date,f=today.getDate(),g=today.getMonth()+1,d=today.getFullYear(),l=today.getHours(),m=today.getMinutes());l=parseInt(l,10);1>=m.length&&(m="0"+m);n=12<=l?"pm":"am";12<l&&(l-=12);"am"==n&&0==l&&(l=12);10>l&&(l="0"+l);var k;k=""+('<div class="dtpicker-wrap" id="dtpicker_'+a+'" style="display: none;">')+
('\t<select tabindex="4" name="dt_month" id="dt_month_'+a+'">');k+='\t\t<option value="01" '+("01"==g?'selected="selected"':"")+">"+sJan+"</option>";k+='\t\t<option value="02" '+("02"==g?'selected="selected"':"")+">"+sFeb+"</option>";k+='\t\t<option value="03" '+("03"==g?'selected="selected"':"")+">"+sMar+"</option>";k+='\t\t<option value="04" '+("04"==g?'selected="selected"':"")+">"+sApr+"</option>";k+='\t\t<option value="05" '+("05"==g?'selected="selected"':"")+">"+sMay+"</option>";k+='\t\t<option value="06" '+
("06"==g?'selected="selected"':"")+">"+sJun+"</option>";k+='\t\t<option value="07" '+("07"==g?'selected="selected"':"")+">"+sJul+"</option>";k+='\t\t<option value="08" '+("08"==g?'selected="selected"':"")+">"+sAug+"</option>";k+='\t\t<option value="09" '+("09"==g?'selected="selected"':"")+">"+sSep+"</option>";k+='\t\t<option value="10" '+("10"==g?'selected="selected"':"")+">"+sOct+"</option>";k+='\t\t<option value="11" '+("11"==g?'selected="selected"':"")+">"+sNov+"</option>";k+='\t\t<option value="12" '+
("12"==g?'selected="selected"':"")+">"+sDec+"</option>";k+="\t</select>";k+='\t<input type="text" autocomplete="off" tabindex="4" maxlength="2" size="2" value="'+f+'" name="dt_day" id="dt_day_'+a+'">, ';k+='\t<input type="text" autocomplete="off" tabindex="4" maxlength="4" size="4" value="'+d+'" name="dt_year" id="dt_year_'+a+'"> @ ';k+='\t<input type="text" autocomplete="off" tabindex="4" maxlength="2" size="2" value="'+l+'" name="dt_hour" id="dt_hour_'+a+'"> : ';k+='\t<input type="text" autocomplete="off" tabindex="4" maxlength="2" size="2" value="'+
m+'" name="dt_min" id="dt_min_'+a+'">';k+='\t<select tabindex="4" name="dt_ampm" id="dt_ampm_'+a+'">';k+='\t\t<option value="am" '+("am"==n?'selected="selected"':"")+">"+sAm+"</option>";k+='\t\t<option value="pm" '+("pm"==n?'selected="selected"':"")+">"+sPm+"</option>";k+="\t</select>";k+='\t<div class="dtpicker-action" id="dtpicker_action_'+a+'">';k+='\t\t<a class="dtpicker-save ui-button" href="javascript:void(0);" onclick="eblog.editor.datetimepicker.save(\''+a+"')\">"+btnOK+"</a>";e&&(k+='\t\t<a class="dtpicker-reset" href="javascript:void(0);" onclick="eblog.editor.datetimepicker.reset(\''+
a+"')\">"+btnReset+"</a>");k+='\t\t<a class="dtpicker-cancel" href="javascript:void(0);" onclick="eblog.editor.datetimepicker.cancel(\''+a+"')\">"+btnCancel+"</a>";k+="\t</div>";k+="</div>";c(k).insertAfter("#datetime_"+a);c("#dtpicker_"+a).slideDown("fast")},reset:function(a){c("#dtpicker_"+a).slideUp("fast");c("#"+a).val("");c("#datetime_"+a+" .datetime_caption").html(sNever);h.editor.datetimepicker.showEditLink(a)},cancel:function(a){c("#dtpicker_"+a).slideUp("fast");"publish_down"!=a||""!=c("#publish_down_ori").val()&&
"0000-00-00 00:00:00"!=c("#publish_down_ori").val()||c("#"+a).val("");c("#datetime_"+a).removeClass("toggle-active");h.editor.datetimepicker.showEditLink(a)},save:function(b){c("#dtpicker_"+b).slideUp("fast");c("#datetime_"+b).removeClass("toggle-active");var e,f,g,d,l;e=c("#dtpicker_"+b+" #dt_day_"+b).val();f=c("#dtpicker_"+b+" #dt_month_"+b).val();f=parseInt(f,10);10>f&&(f="0"+f);g=c("#dtpicker_"+b+" #dt_year_"+b).val();d=c("#dtpicker_"+b+" #dt_hour_"+b).val();if("pm"==c("#dtpicker_"+b+" #dt_ampm_"+
b).val())switch(parseInt(d,10)){case 12:break;default:d=parseInt(d,10)+12}else switch(parseInt(d)){case 12:d="00";break;default:1>=d.length&&(d="0"+d)}l=c("#dtpicker_"+b+" #dt_min_"+b).val();1>=l.length&&(l="0"+l);e=g+"-"+f+"-"+e+" "+d+":"+l+":00";c("#"+b).val(e);a.load("dashboard","updateDisplayDate",b,e);h.editor.datetimepicker.showEditLink(b)},showEditLink:function(a){c("#datetime_edit_"+a).show()},hideEditLink:function(a){c("#datetime_edit_"+a).hide()}},permalink:{edited:!1,generate:function(){""==
c("#title").val()||h.editor.permalink.edited||a.load("dashboard","getPermalink",c("#title").val())},edit:function(){"none"==c("#permalink-edit").css("display")?(h.editor.permalink.edited=!0,c("#permalink-edit").show(),c("#permalink-value").hide()):(c("#permalink-edit").hide(),c("#permalink-value").show())},save:function(){c("#permalink-url").html(c("#permalink-data").val());h.editor.permalink.edit()}}},tags:{search:{init:function(){c("#filter-tags").keyup(function(){var a=c.trim(c(this).val());c(".post-tags li").hide().filter(function(){return 0<=
(this.textContent||this.innerText||"").toUpperCase().indexOf(a.toUpperCase())}).show()})}}},loader:{item:null,loading:function(a){h.loader.item=a;c("#"+a).addClass("eblog_loader");c("#"+a).show()},doneLoading:function(){null!=h.loader.item&&c("#"+h.loader.item).removeClass("eblog_loader")}},comment:{likes:function(b,c,f){h.loader.loading("likes-"+b);a.load("Entry","likesComment",b,c,f)},save:function(){c("#eblog-message").removeClass("info error");c("#eblog-message").html("");h.loader.loading("comment-form-title");
finalData=a.getFormVal("#frmComment");a.load("Entry","commentSave",finalData);0<c("#empty-comment-notice").length&&c("#empty-comment-notice").fadeOut("100")},reply:function(a,e,f){c(".cancel_container").hide();c(".reply_container").show();c("#comment-reply-form-"+a).show();var g=c("#eblog-wrapper #frmComment").clone();c("#eblog-wrapper #frmComment").remove();c("#comment-reply-form-"+a).addClass("comment-form-inline").append(g);c("#parent_id").val(a);c("#comment_depth").val(e);f&&(e=c("#comment-title-"+
a).text(),e=""!=e?"RE:"+e:"",c("#title.inputbox").val(e));c(".comment-reply-no").removeClass("show-this");c(".comment-reply-yes").addClass("show-this");c("#toolbar-reply-"+a).removeClass("show-this");c("#toolbar-cancel-"+a).addClass("show-this");c("#toolbar-cancel-"+a).parent(".comment-reply").toggleClass("in-action");0<c(".markItUpContainer").length&&(c("#comment").markItUpRemove(),c("#comment").markItUp(EasyBlogBBCodeSettings))},cancel:function(a){var e=c("#eblog-wrapper #comment-reply-form-"+a+
" #frmComment").clone();c("#eblog-wrapper #comment-reply-form-"+a+" #frmComment").remove();c("#eblog-wrapper #comment-separator").after(e);c("#parent_id").val("0");c("#comment_depth").val("0");c("#comment-reply-form-"+a).hide();c("#title.inputbox").val("");c("#toolbar-reply-"+a).toggleClass("show-this");c("#toolbar-cancel-"+a).toggleClass("show-this");c("#toolbar-cancel-"+a).parent(".comment-reply").toggleClass("in-action");0<c(".markItUpContainer").length&&(c("#comment").markItUpRemove(),c("#comment").markItUp(EasyBlogBBCodeSettings))},
edit:function(){c("#eblog-message").removeClass("info error");c("#eblog-message").html("");finalData=a.getFormVal("#frmComment");a.load("dashboard","updateComment",finalData)},action:function(b,e){var f=0,g="",d=c("#"+b).val();""==d?h.system.alert("COM_EASYBLOG_PLEASE_SELECT_ACTION_TO_PERFORM","COM_EASYBLOG_WARNING"):(c("#adminForm INPUT[name='cid[]']").each(function(){c(this).attr("checked")&&(g=0==g.length?c(this).val():g+","+c(this).val(),f++)}),0>=f?h.system.alert("COM_EASYBLOG_PLEASE_SELECT_ONE_ITEM_TO_CONTINUE",
"COM_EASYBLOG_WARNING"):"unpublishComment"==d?a.load("dashboard","publishComment",g,"0","comment"):"publishComment"==d?a.load("dashboard","publishComment",g,"1","comment"):"removeComment"==d&&h.comment.confirm(e,g,""))},confirm:function(a,c,f){h.system.dialog("COM_EASYBLOG_ARE_YOU_SURE_YOU_WANT_TO_REMOVE_COMMENT",'window.location = "'+(a+"&task=removeComment&commentId="+c)+'";',"CONFIRMATION")},displayInlineMsg:function(a,e){c("#eblog-message").removeClass("info error");c("#eblog-message").html(e);
c("#eblog-message").addClass(a);"info"==a&&setTimeout(function(){c("#eblog-message").removeClass("info error");c("#eblog-message").html("")},6E3)}},featured:{add:function(b,c){a.load("Latest","makeFeatured",b,c)},remove:function(b,c){a.load("Latest","removeFeatured",b,c)},slider:{holderWidth:0,element:[],autorotate:function(a){var e=c("#ezblog-featured .featured-a").children(),f=!1;c(e).each(function(){c(this).hasClass("active")&&!0!=f&&(0==c(this).next().length?c("#ezblog-featured .featured-a :first").click():
c(this).next().click(),f=!0)});setTimeout("eblog.featured.slider.autorotate("+a+");",a)},init:function(a,e,f){h.featured.slider.element[a]={width:parseInt(c("."+a).parent().width()),element:"."+a};var g=0;c(h.featured.slider.element[a].element).children().each(function(){g+=h.featured.slider.element[a].width});c(h.featured.slider.element[a].element).css("width",g);c(h.featured.slider.element[a].element).children().css("width",h.featured.slider.element[a].width);e&&(f=1E3*parseInt(f),setTimeout("eblog.featured.slider.autorotate("+
f+");",f))},slide:function(a,e){var f=0,g=a;1!=a&&(f=h.featured.slider.element[e].width*parseInt(a-1));c(h.featured.slider.element[e].element).animate({left:"-"+f+"px"},"slow");c(h.featured.slider.element[e].element).parent().parent().children("div.featured-navi").children().children().removeClass("active");c(h.featured.slider.element[e].element).parent().parent().children("div.featured-navi").children().children(".slider-navi-"+g).addClass("active")}}},spinner:{show:function(){c("#blogSubmitBtn").hide();
c("#blogSubmitWait").show()},hide:function(){c("#blogSubmitWait").hide();c("#blogSubmitBtn").show()},publish:function(a,e){1==e?c("#"+a+"Spinner").html('<img src="'+spinnerPath+'" alt="Loading">'):c("#"+a+"Spinner").html("")}},element:{focus:function(b){ele="#"+b;c(ele).focus();a.closedlg()}},blog:{publish:function(a,c,f){window.location=a+"&task=toggleBlogStatus&status="+f+"&blogId="+c},remove:function(b,e){var f="",g=e?e:"Dashboard";c.each(b,function(){h.spinner.publish(b,1);""!=f&&(f+=",");f+=
this});a.load("Dashboard","deleteBlog",f,g)},confirmDelete:function(b,c){a.load("dashboard","confirmDelete",b,c)},confirm:function(a,c,f){},approve:function(b,c){a.load("dashboard","confirmApproveBlog",c,b)},ajaxpublish:function(b,e,f){var g="";f=f?f:"Dashboard";c.each(b,function(){h.spinner.publish(b,1);""!=g&&(g+=",");g+=this});a.load("Dashboard","togglePublishStatus",g,e,f)},togglePublish:function(b,c){a.load("dashboard","togglePublish",b,c)},action:function(a,e){var f=0,g="",d=c("#"+a).val();
"default"!=d&&(c("#adminForm INPUT[name='cid[]']").each(function(){c(this).attr("checked")&&(g=0==g.length?c(this).val():g+","+c(this).val(),f++)}),0>=f?h.system.alert("COM_EASYBLOG_PLEASE_SELECT_ONE_ITEM_TO_CONTINUE","COM_EASYBLOG_WARNING"):"unpublishBlog"==d?h.blog.togglePublish(g,"unpublish"):"publishBlog"==d?h.blog.togglePublish(g,"publish"):"deleteBlog"==d&&h.blog.confirmDelete(g,e))},tab:{init:function(){c(".tab_container").hide();c("div.tab-wrapper .tab_container:first").show();c(".tab_item:first").addClass("item-active");
c("ul.tab_button li.tab_item a").click(function(){var a=c(this).parent();if(a.hasClass("item-active"))return!1;a.siblings().each(function(){c(this).hasClass("item-active")&&c(this).removeClass("item-active")});a.addClass("item-active");c(".tab_container").hide();a=a.attr("id").split("-")[1];c("#section-"+a).show();return!1})}},unsubscribe:function(b,c){a.load("entry","confirmUnsubscribeBlog",b,c)}},tag:{remove:function(b,c){a.load("Dashboard","confirmDeleteTag",c,b)},edit:function(b){a.load("Dashboard",
"editTagDialog",b)},action:function(a,e){var f=0,g="",d=c("#"+a).val();""==d?h.system.alert("COM_EASYBLOG_PLEASE_SELECT_ACTION_TO_PERFORM","COM_EASYBLOG_WARNING"):(c("#adminForm INPUT[name='cid[]']").each(function(){c(this).attr("checked")&&(g=0==g.length?c(this).val():g+","+c(this).val(),f++)}),0>=f?h.system.alert("COM_EASYBLOG_PLEASE_SELECT_ONE_ITEM_TO_CONTINUE","COM_EASYBLOG_WARNING"):"deleteTag"==d&&h.tag.confirm(e,g,""))},confirm:function(a,c,f){h.system.dialog("COM_EASYBLOG_ARE_YOU_SURE_YOU_WANT_TO_REMOVE_TAGS",
'window.location = "'+(a+"&task=deleteTag&tagId="+c)+'";',"CONFIRMATION")},save:function(){finalData=a.getFormVal("#frmEditTag");a.load("Dashboard","saveTag",finalData)}},socialshare:{share:function(b,c){h.spinner.publish(b,1);a.load("dashboard","ajaxSocialShare",b,c)}},twitter:{update:function(b){""!=b&&(h.spinner.publish(b,1),a.load("Dashboard","ajaxUpdateTwitter",b))}},form:{checkbox:{checkall:function(){c("#adminForm INPUT[type='checkbox']").each(function(){c("#toggle").attr("checked")?c(this).attr("checked",
!0):c(this).attr("checked",!1)});return!1}}},trackback:{url:{copy:function(){c("#trackback-url").focus().select()}}},system:{alert:function(b,c){a.alert(a.string(b),a.string(c),"450","auto")},dialog:function(b,c,f){c='<div class="dialog-actions"><input type="button" value="'+a.string("No")+'" class="button" id="edialog-cancel" name="edialog-cancel" onclick="ejax.closedlg();" /><input type="button" value="'+a.string("Yes")+'" class="button" id="edialog-submit" name="edialog-submit" onclick="'+c+'" /></div>';
b={title:a.string(f),content:a.string(b)+c};a.dialog(b)},loader:function(a){if(a){0<c("img#easyblog-loader").length&&c("img#easyblog-loader").remove();a=new Image;a.src="/components/com_easyblog/assets/images/loader.gif";a.name="easyblog-loader";a.id="easyblog-loader";var e=c("div#eblog-wrapper"),f=e.width();divHeight=window.innerHeight||self.innerHeight||window.parent.document.body.clientHeight;e.prepend(a);c("img#easyblog-loader").css("marginTop",divHeight/2);c("img#easyblog-loader").css("marginLeft",
f/2);c("img#easyblog-loader").css("position","absolute");c("img#easyblog-loader").css("z-index",10)}else 0<c("img#easyblog-loader").length&&c("img#easyblog-loader").remove()}},teamblog:{join:function(b){a.load("TeamBlog","showDialog",String(b),"join")},leave:function(b){a.load("TeamBlog","showDialog",String(b),"leave")},leaveteam:function(){h.loader.loading("eblog_loader");a.load("teamblog","leaveTeam",a.getFormVal("#frmLeave"))},send:function(){h.loader.loading("eblog_loader");a.load("teamblog",
"addJoinRequest",a.getFormVal("#frmJoin"))},approve:function(){},reject:function(){}},calendar:{reload:function(b,c,f,g,d,l,m){a.load(b,c,f,g,d,l,m)},showtooltips:function(a){c(".easyblog_calendar_tooltips").hide();c("#com_easyblog_calendar_day_"+a).show()}}},a=window.ejax={http:!1,format:"text",callback:function(a){},error:!1,getHTTPObject:function(){var a=!1;if("undefined"!=typeof ActiveXObject)try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(c){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(f){a=
!1}}else if(XMLHttpRequest)try{a=new XMLHttpRequest}catch(g){a=!1}return a},call:function(b,c,f,g){b=[{view:b,callback:g},c];b=b.concat(f);a.load.apply(this,b)},load:function(a,e){var f={success:function(){},error:function(){}};"object"==typeof a&&(f=c.extend(f,c.isFunction(a.callback)?{success:a.callback}:a.callback),a=a.view);url=eblog_site;url+="&tmpl=component";url+="&no_html=1";url+="&format=ejax";url+="&"+EasyBlog.getToken()+"=1";url+="&uid="+(new Date).getTime();var g="&view="+a+"&layout="+
e;if(2<arguments.length)for(var d=2;d<arguments.length;d++){var l=arguments[d];if(c.isArray(l))for(var m=0;m<l.length;m++){var n=l[m];"string"==typeof n&&(g+="&value"+(d-2)+"[]="+encodeURIComponent(n))}else n=l,"string"==typeof n&&(g+="&value"+(d-2)+"="+encodeURIComponent(n))}var h=this.getHTTPObject();if(h&&a&&e){var p=this;h.open("POST",url,!0);h.setRequestHeader("Content-type","application/x-www-form-urlencoded");h.onreadystatechange=function(){if(4==h.readyState)if(200==h.status){var a="";h.responseText&&
(a=h.responseText);a=a.replace(/[\n\r]/g,"");try{a=eval(a)}catch(d){f.error&&f.error("Invalid response.")}p.process(a,f)}else p.error&&(p.error(h.status),f.error&&f.error(h.status))};h.send(g)}},_string:[],string:function(b){if(void 0!=a._string[b])return a._string[b];var e=c.ajax({type:"POST",url:eblog_site+"&tmpl=component&no_html=1&controller=easyblog&task=ajaxGetSystemString",data:"data="+b,async:!1,cache:!0}).responseText;return a._string[b]=e},getFormVal:function(a){var e=[],f=null;c(":input",
c(a)).each(function(){f=this.value.replace(/"/g,"&quot;");f=encodeURIComponent(f);c(this).is(":checkbox")||c(this).is(":radio")?c(this).prop("checked")&&e.push(this.name+"="+escape(f)):e.push(this.name+"="+escape(f))});return e},process:function(b,e){for(var f=0;f<b.length;f++)switch(b[f][0]){case "script":eval("EasyBlog(function($){"+b[f][1]+"});");break;case "after":var g=b[f][1],d=b[f][2];c("#"+g).after(d);break;case "append":g=b[f][1];d=b[f][2];c("#"+g).append(d);break;case "assign":g=b[f][1];
d=b[f][2];c("#"+g).html(d);break;case "value":g=b[f][1];d=b[f][2];c("#"+g).val(d);break;case "prepend":g=b[f][1];d=b[f][2];c("#"+g).prepend(d);break;case "destroy":g=b[f][1];c("#"+g).remove();break;case "dialog":a.dialog(b[f][1]);break;case "alert":a.alert(b[f][1],b[f][2],b[f][3],b[f][4]);break;case "error":g=b[f].slice(1);e.error.apply(this,g);break;case "callback":g=b[f].slice(1),e.success.apply(this,g)}delete b},dialog:function(b){a._showPopup(b)},closedlg:function(){var b=c("#eblog-dialog"),e=
c("#eblog-overlay"),f=b.data("options");e.hide();b.fadeOut(function(){f.afterClose.apply(b)});c(window).unbind(".dialog");c(document).unbind("keyup",a._attachPopupShortcuts)},_attachPopupShortcuts:function(b){27==b.keyCode&&a.closedlg()},alert:function(b,c,f,g){var d='<div class="dialog-actions"><input type="button" value="'+a.string("COM_EASYBLOG_OK")+'" class="button" id="edialog-cancel" name="edialog-cancel" onclick="ejax.closedlg();" /></div>';a._showPopup({title:c,content:b+d,width:f,height:g})},
_showPopup:function(b){b=c.extend({},{width:"500",height:"auto",type:"dialog",beforeDisplay:function(){},afterDisplay:function(){},afterClose:function(){}},b);var e=c("#eblog-overlay");1>e.length&&(e='<div id="eblog-overlay"></div>',e=c(e).appendTo("body"),e.click(function(){a.closedlg()}));var f=c("#eblog-dialog");1>f.length&&(dialogTemplate='<div id="eblog-dialog">',dialogTemplate+='\t<div class="dialog">',dialogTemplate+='\t\t<div class="dialog-wrap">',dialogTemplate+='\t\t\t<div class="dialog-top">',
dialogTemplate+="\t\t\t\t<h3></h3>",dialogTemplate+='\t\t\t\t<a href="javascript:void(0);" onclick="ejax.closedlg();" class="closeme">Close</a>',dialogTemplate+="\t\t\t</div>",dialogTemplate+='\t\t\t<div class="dialog-middle clearfix">',dialogTemplate+='\t\t\t\t<div class="dialog-middle-content"></div>',dialogTemplate+="\t\t\t</div>",dialogTemplate+="\t\t</div>",dialogTemplate+="\t</div>",dialogTemplate+="</div>",f=c(dialogTemplate).appendTo("body"));f.data("options",b);var g=f.find(".dialog-top h3");
b.title=null!=b.title?b.title:"&nbsp;";g.html(unescape(b.title));c("#eblog-dialog .dialog-middle-content").css({width:"auto"==b.width?"auto":parseInt(b.width),height:"auto"==b.height?"auto":parseInt(b.height)}).html(b.content);b.beforeDisplay.apply(f);var d=function(){f.css({top:0,left:0}).position({my:"center",at:"center",of:window});e.css({width:c(document).width(),height:c(document).height()}).show()};f.show(0,function(){d();var a;c(window).bind("resize.dialog scroll.dialog",function(){clearTimeout(a);
a=setTimeout(d,50)})});f.fadeOut(0,function(){f.fadeIn(function(){b.afterDisplay.apply(f)})});c(document).on("click.eb.dialog","#edialog-cancel, #edialog-submit",function(){a.closedlg()});c(document).bind("keyup",a._attachPopupShortcuts)}};this.resolve()});EasyBlog.module("featured",function(c){var h=this;EasyBlog.require().done(function(){EasyBlog.Controller("Featured.Scroller",{defaultOptions:{elements:null,itemWidth:null,autorotate:{enabled:!1,interval:50},"{placeHolder}":".slider-holder","{slider}":".featured-entries",
"{sliderItems}":".slider-holder ul li","{sliderNavigation}":".featured-navi .featured-a a"}},function(a){return{init:function(){a.options.itemWidth=a.placeHolder().width()+1;var b=a.sliderItems().length*parseInt(a.options.itemWidth);a.slider().css("width",b);a.sliderItems().css("width",a.options.itemWidth);a.options.autorotate.enabled&&setTimeout(function(){a.initAutoRotate()},1E3*parseInt(a.options.autorotate.interval))},"{sliderNavigation} click":function(b){var e=c(b).data("slider"),f=0;1!=e&&
(f=a.options.itemWidth*parseInt(e-1));a.slider().children(":nth-child("+e+")").show();a.slider().animate({left:"-"+f+"px"},"slow");a.sliderNavigation(".active").removeClass("active");c(b).addClass("active")},initAutoRotate:function(){var b=!1;a.sliderNavigation().each(function(){c(this).hasClass("active")&&!0!=b&&(0==c(this).next().length?a.sliderNavigation(":first").click():c(this).next().click(),b=!0)});setTimeout(function(){a.initAutoRotate()},1E3*parseInt(a.options.autorotate.interval))}}});h.resolve()})});
EasyBlog.module("location",function(c){var h=this;EasyBlog.require().library("ui/autocomplete").done(function(){EasyBlog.Controller("Location.Form",{defaultOptions:{language:"en",initialLocation:null,mapType:"ROADMAP","{locationInput}":".locationInput","{locationLatitude}":".locationLatitude","{locationLongitude}":".locationLongitude","{locationMap}":".locationMap","{autoDetectButton}":".autoDetectButton"}},function(a){return{init:function(){var b=c.uid("ext");window[b]=function(){c.___GoogleMaps.resolve()};
c.___GoogleMaps||(c.___GoogleMaps=c.Deferred(),EasyBlog.require().script({prefetch:!1},"https://maps.googleapis.com/maps/api/js?sensor=true&language="+a.options.language+"&callback="+b));c.___GoogleMaps.done(function(){a._init()})},_init:function(b,e){a.geocoder=new google.maps.Geocoder;a.hasGeolocation=void 0!==navigator.geolocation;a.hasGeolocation?a.autoDetectButton().show():a.autoDetectButton().remove();a.locationInput().autocomplete({delay:300,minLength:0,source:a.retrieveSuggestions,select:function(b,
d){a.locationInput().autocomplete("close");a.setLocation(d.item.location)}}).prop("disabled",!1);a.autocomplete=a.locationInput().autocomplete("widget");a.autocomplete.addClass("location-suggestion");var f=c.trim(a.options.initialLocation);f&&a.getLocationByAddress(f,function(b){a.setLocation(b[0])});a.busy(!1)},busy:function(b){a.locationInput().toggleClass("loading",b)},getUserLocations:function(b){a.getLocationAutomatically(function(c){a.userLocations=a.buildDataset(c);b&&b(c)})},getLocationByAddress:function(b,
c){a.geocoder.geocode({address:b},c)},getLocationByCoords:function(b,c,f){a.geocoder.geocode({location:new google.maps.LatLng(b,c)},f)},getLocationAutomatically:function(b,c){if(!navigator.geolocation)return c("ERRCODE","Browser does not support geolocation or do not have permission to retrieve location data.");navigator.geolocation.getCurrentPosition(function(c){a.getLocationByCoords(c.coords.latitude,c.coords.longitude,b)},c)},renderMap:function(b,c){a.busy(!0);a.locationMap().show();var f=new google.maps.Map(a.locationMap()[0],
{zoom:15,center:b.geometry.location,mapTypeId:google.maps.MapTypeId[a.options.mapType],disableDefaultUI:!0}),g=new google.maps.Marker({position:b.geometry.location,center:b.geometry.location,title:b.formatted_address,map:f}),d=new google.maps.InfoWindow({content:c});google.maps.event.addListener(f,"tilesloaded",function(){d.open(f,g);a.busy(!1)})},setLocation:function(b){b&&(a.locationResolved=!0,a.lastResolvedLocation=b,a.locationInput().val(b.formatted_address),a.locationLatitude().val(b.geometry.location.lat()),
a.locationLongitude().val(b.geometry.location.lng()),a.renderMap(b,b.formatted_address))},removeLocation:function(){a.locationResolved=!1;a.locationInput().val("");a.locationLatitude().val("");a.locationLongitude().val("");a.locationMap().hide()},buildDataset:function(a){return c.map(a,function(a){return{label:a.formatted_address,value:a.formatted_address,location:a}})},retrieveSuggestions:function(b,c){a.busy(!0);var f=b.term,g=function(d){c(d);a.busy(!1)};""==f?g(a.userLocations||[]):a.getLocationByAddress(f,
function(d){g(a.buildDataset(d))})},suggestUserLocations:function(){a.hasGeolocation&&a.userLocations&&(a.removeLocation(),a.locationInput().autocomplete("search",""));a.busy(!1)},"{locationInput} blur":function(){setTimeout(function(){var b=c.trim(a.locationInput().val());""==b?a.removeLocation():a.locationResolved?b!=a.lastResolvedLocation.formatted_address&&a.setLocation(a.lastResolvedLocation):a.removeLocation()},250)},"{autoDetectButton} click":function(){a.busy(!0);a.hasGeolocation&&!a.userLocations?
a.getUserLocations(a.suggestUserLocations):a.suggestUserLocations()}}});EasyBlog.Controller("Location.Map",{defaultOptions:{animation:"drop",language:"en",useStaticMap:!1,disableMapsUI:!0,zoom:5,fitBounds:null,minZoom:null,maxZoom:null,center:null,locations:[],mapType:"ROADMAP",width:500,height:400,"{locationMap}":".locationMap"}},function(a){return{init:function(){a.mapLoaded=!1;var b=c.uid("ext");window[b]=function(){c.___GoogleMaps.resolve()};if(!0==a.options.useStaticMap){var e="&language="+String(a.options.language),
f="&size="+String(a.options.width)+"x"+String(a.options.height),b="&zoom="+String(a.options.zoom),g="&center="+String(parseFloat(a.options.locations[0].latitude).toFixed(6))+","+String(parseFloat(a.options.locations[0].longitude).toFixed(6)),d="&maptype="+google.maps.MapTypeId[a.options.mapType],l="&markers=",e="https://maps.googleapis.com/maps/api/staticmap?sensor=false"+e+f;if(1==a.options.locations.length)l+=String(parseFloat(a.options.locations[0].latitude).toFixed(6))+","+String(parseFloat(a.options.locations[0].longitude).toFixed(6)),
e+=b+g+d+l;else{var m=[];c.each(a.options.locations,function(a,d){m.push(String(parseFloat(d.latitude).toFixed(6))+","+String(parseFloat(d.longitude).toFixed(6)))});l+=m.join("|");e+=l+d}a.locationMap().show().html('<img src="'+e+'" />');a.busy(!1)}else b=c.uid("ext"),window[b]=function(){c.___GoogleMaps.resolve()},c.___GoogleMaps||(c.___GoogleMaps=c.Deferred(),EasyBlog.require().script({prefetch:!1},"https://maps.googleapis.com/maps/api/js?sensor=true&language="+a.options.language+"&callback="+b)),
c.___GoogleMaps.done(function(){a._init()})},_init:function(){null===a.options.fitBounds&&(a.options.fitBounds=1==a.options.locations.length?!1:!0);a.options.disableMapsUI=Boolean(a.options.disableMapsUI);a.locations=[];c.each(a.options.locations,function(b,c){"null"!=c.latitude&&"null"!=c.longitude&&a.locations.push(new google.maps.LatLng(c.latitude,c.longitude))});0<a.locations.length&&a.renderMap();a.busy(!1)},busy:function(b){a.locationMap().toggleClass("loading",b)},renderMap:function(){a.busy(!0);
a.locationMap().show();var b;b=a.options.center?new google.maps.LatLng(center.latitude,center.longitude):a.locations[0];a.map=new google.maps.Map(a.locationMap()[0],{zoom:parseInt(a.options.zoom),minZoom:parseInt(a.options.minZoom),maxZoom:parseInt(a.options.maxZoom),center:b,mapTypeId:google.maps.MapTypeId[a.options.mapType],disableDefaultUI:a.options.disableMapsUI});google.maps.event.addListener(a.map,"tilesloaded",function(){!1==a.mapLoaded&&(a.mapLoaded=!0,a.loadLocations())})},loadLocations:function(){a.bounds=
new google.maps.LatLngBounds;a.infoWindow=[];setTimeout(function(){c.each(a.locations,function(b,c){a.bounds.extend(c);setTimeout(function(){a.addMarker(c,a.options.locations[b])},100*(b+1))});a.options.fitBounds&&a.map.fitBounds(a.bounds)},500)},addMarker:function(b,c){if(b){var f=new google.maps.Marker({position:b,map:a.map});f.setAnimation(google.maps.Animation.DROP);a.addInfoWindow(f,c)}},addInfoWindow:function(b,e){var f=e.content;f||(f=e.address);var g=new google.maps.InfoWindow;g.setContent(f);
a.infoWindow.push(g);1<a.options.locations.length?google.maps.event.addListener(b,"click",function(){c.each(a.infoWindow,function(a,b){b.close()});g.open(a.map,b)}):(google.maps.event.addListener(b,"click",function(){g.open(a.map,b)}),g.open(a.map,b));e.ratingid&&google.maps.event.addListener(g,"domready",function(){c.each(e.ratingid,function(a,b){eblog.ratings.setup("ebpostmap_"+b+"-ratings",!0,"entry");c("#ebpostmap_"+b+"-ratings").removeClass("ui-state-disabled");c("#ebpostmap_"+b+"-ratings-form").find(".blog-rating-text").hide();
c("#ebpostmap_"+b+"-ratings .ratings-value").hide()})})}}});h.resolve()})});EasyBlog.module("media",function(c){var h=this,a=function(a){return c("<div>").text(a).html().replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")},b,e;EasyBlog.Controller("Media",{defaultOptions:{debug:{logging:EasyBlog.debug,itemVisibility:!1,delayConfiguration:0,delayCommon:0,delayBrowser:0,delayUploader:0,delayEditor:0},ui:"#EasyBlogMediaManagerUI",overlay:{background:"black",opacity:0},modal:{size:0.9},
recentActivities:{hideAfter:3E3},"{modalGroup}":".mediaModalGroup","{modal}":".mediaModal","{loaderModal}":".loaderModal","{uploaderModal}":".uploaderModal","{browserModal}":".browserModal","{editorModal}":".editorModal","{modalContent}":".modalContent","{overlay}":".media-overlay","{modalDashboardButton}":".dashboardButton","{assetItem}":".assetItem"}},function(a){return{console:function(d,b){if(a.options.debug.logging){var c=window.console;c&&(d=c[d])&&(d.apply?d.apply(c,b):d(b.join(" ")))}},assets:{},
getAsset:function(d){void 0===a.assets[d]&&(a.assets[d]=c.Deferred()).done(function(){a.assetItem(".asset-type-"+d).removeClass("loading done failed").addClass("done")}).fail(function(){a.assetItem(".asset-type-"+d).removeClass("loading done failed").addClass("fail")});return a.assets[d]},createAsset:function(d,b,c){var e=a.getAsset(d);e.factory=b;setTimeout(function(){e.factory&&e.factory(e)},c);return e},init:function(){b=a;a.IE=function(){for(var a=3,d=document.createElement("div"),b=d.getElementsByTagName("i");d.innerHTML=
"\x3c!--[if gt IE "+ ++a+"]><i></i><![endif]--\x3e",b[0];);return 4<a?a:void 0}();if("undefined"!=typeof tinyMCE&&tinyMCE&&tinyMCE.isIE&&9==a.IE)var d=setInterval(function(){var b=tinyMCE.editors.write_content;b&&(c(b.contentWindow).off("keydown.mediaManager mousedown.mediaManager focus.mediaManager").on("keydown.mediaManager mousedown.mediaManager focus.mediaManager",function(){a.bookmark={element:b.selection.getEnd(),range:b.selection.getBookmark(1).rng}}),clearInterval(d))},500);a.originalBodyOverflow=
c("body").css("overflow");a.createAsset("configuration",function(d){EasyBlog.module("media/configuration").done(function(){a.initialize(this);d.resolve()}).fail(function(){d.reject()})},a.options.debug.delayConfiguration);a.createAsset("common",function(a){EasyBlog.require().script("media/navigation").view("media/recent.item","media/browser","media/browser.item-group","media/browser.item","media/browser.tree-item-group","media/browser.tree-item","media/browser.pagination-page","media/browser.uploader",
"media/browser.uploader.item","media/editor","media/editor.viewport","media/navigation.item","media/navigation.itemgroup").language("COM_EASYBLOG_MM_UNABLE_TO_FIND_EXPORTER","COM_EASYBLOG_MM_GETTING_IMAGE_SIZES","COM_EASYBLOG_MM_UNABLE_TO_RETRIEVE_VARIATIONS","COM_EASYBLOG_MM_ITEM_INSERTED","COM_EASYBLOG_MM_UPLOADING","COM_EASYBLOG_MM_UPLOADING_STATE","COM_EASYBLOG_MM_UPLOADING_PENDING","COM_EASYBLOG_MM_UPLOAD_COMPLETE","COM_EASYBLOG_MM_UPLOAD_PREPARING","COM_EASYBLOG_MM_UPLOAD_UNABLE_PARSE_RESPONSE",
"COM_EASYBLOG_MM_UPLOADING_LEFT","COM_EASYBLOG_MM_CONFIRM_DELETE_ITEM","COM_EASYBLOG_MM_CANCEL_BUTTON","COM_EASYBLOG_MM_YES_BUTTON","COM_EASYBLOG_MM_ITEM_DELETE_CONFIRMATION").done(function(){a.resolve()}).fail(function(){a.reject()})},a.options.debug.delayCommon);a.createAsset("uploader",function(d){c.when(a.getAsset("configuration"),a.getAsset("common"),EasyBlog.require().script("media/uploader").done()).done(function(){var b=a.createModal("uploader");b.controller=new EasyBlog.Controller.Media.Uploader(b.element,
a.options.uploader);d.resolve()}).fail(function(){d.reject()})},a.options.debug.delayUploader);a.createAsset("browser",function(d){c.when(a.getAsset("configuration"),a.getAsset("common"),EasyBlog.require().script("media/browser").done()).done(function(){var b=a.createModal("browser");b.controller=new EasyBlog.Controller.Media.Browser(b.element,a.options.browser);d.resolve()}).fail(function(){d.reject()})},a.options.debug.delayBrowser);a.createAsset("editor",function(d){c.when(a.getAsset("browser"),
EasyBlog.require().script("media/editor").done()).done(function(){var b=a.createModal("editor");b.controller=new EasyBlog.Controller.Media.Editor(b.element,a.options.editor);d.resolve()}).fail(function(){d.reject()})},a.options.debug.delayEditor);a.setLayout=c.debounce(a._setLayout,200)},initialize:function(d){var b={controller:{media:a}};d=c.extend(!0,d,{browser:b,uploader:b,library:b,editor:b,exporter:b});a.update(d);e=d.directorySeparator;d=c(a.options.ui);a.element.append(d.html());d.remove();
a.overlay().css(a.options.overlay);a.loader=new EasyBlog.Controller.Media.Loader(a.createModal("loader"),{controller:{media:a}});a.element.implement(EasyBlog.Controller.Media.Library,a.options.library,function(){});a.element.implement(EasyBlog.Controller.Media.Exporter,a.options.exporter);h.resolve()},setLayout:function(){a._setLayout()},_setLayout:function(){a.layout=a.element.hasClass("active")?c.uid():null;a.layout&&a.setModalLayout();return a.layout},modals:{},createModal:function(d){var b=a.modal("."+
d+"Modal");1>b.length&&(b=c('<div class="mediaModal"></div>').addClass(d+"Modal").appendTo(a.modalGroup()));return a.modals[d]={name:d,element:b}},activateModal:function(d,b){if(void 0===a.modals[d])a.loader.when(a.assets[d]).done(function(){setTimeout(function(){a.activateModal(d,b)},1E3)});else{if(a.currentModal===d)return!0;var c=a.modals[d];if(!c)return!1;a.deactivateModal(a.currentModal);a.currentModal=d;a.show();(c=c.controller)&&c.trigger("modalActivate",b);return!0}},deactivateModal:function(d,
b){var c=a.modals[d];if(!c)return!1;var e=c.controller;if(e)try{e.trigger("modalDeactivate",b)}catch(f){console.error(f)}c.element.removeClass("active");a.currentModal=void 0;return!0},setModalLayout:function(){clearTimeout(a.setModalLayout.task);var d=a.modals[a.currentModal];if(d){if(!a.layout)return a._setLayout();d.element.addClass("active");var b=d.controller;if(b&&c.isFunction(b.setLayout)){var e=function(){var d=b.element.offset();0===d.top||0===d.left?a.setModalLayout.task=setTimeout(e,50):
b.setLayout()};e()}}},show:function(){a.element.addClass("active");a._setLayout();a.trigger("showModal")},hide:function(){a.element.removeClass("active");a.deactivateModal(a.currentModal);a.trigger("hideModal")},"{overlay} click":function(){a.hide()},"{window} resize":function(){a.setLayout()},"{modalDashboardButton} click":function(d,b){if(b.shiftKey)return a.console("dir",[a]);a.hide()},upload:function(){a.activateModal("uploader",arguments)},browse:function(){a.activateModal("browser",arguments)},
edit:function(){a.activateModal("editor",arguments)}}});EasyBlog.Controller("Media.Loader",{defaultOptions:{}},function(a){return{init:function(){},when:function(){a.media.activateModal("loader");var d=c.when.apply(null,arguments),b=d.done;d.id=c.uid();d.done=function(c){b(function(){a.currentQueueId==d.id&&c&&c()})};a.currentQueueId=d.id;return d},"{self} hide":function(){a.currentQueueId=null}}});EasyBlog.Controller("Media.Prompt",{defaultOptions:{"{dialog}":".modalPromptDialog","{cancelButton}":".promptCancelButton"}},
function(a){return{init:function(){},get:function(d){d=a.dialog("."+d);return a.instantiate(d)},instantiate:function(d){var b={element:d,show:function(){d.addClass("active");a.element.addClass("active");return b},hide:function(){d.removeClass("active");a.element.removeClass("active");return b},state:function(a){var c=d.data("lastPromptState");if(void 0===a)return c;var g=d.find(".promptState.state-"+a),c=d.find(".promptState.state-"+c);if(!(1>g.length))return c.removeClass("active"),g.addClass("active"),
d.data("lastPromptState",a),b}};return b},hideAll:function(){a.dialog().removeClass("active");a.element.removeClass("active")},"{cancelButton} click":function(){a.hideAll()}}});EasyBlog.Controller("Media.Library",{defaultOptions:{places:[],place:{files:{},acl:{canCreateFolder:!1,canUploadItem:!1,canRenameItem:!1,canRemoveItem:!1,canCreateVariation:!1,canDeleteVariation:!1},populateImmediately:!1}}},function(a){return{init:function(){a.media.library=a;c.each(a.options.places,function(d,b){a.addPlace(b)})},
places:{},getPlace:function(d){if(d){if(d.acl)return d;if("string"===typeof d)return a.places[d.split("|")[0]]}},addPlace:function(d){d=a.places[d.id]=c.extend({tasks:c.Threads({threadLimit:1}),ready:c.Deferred(),baseFolder:function(){return a.getMeta(d.id+"|"+a.media.options.directorySeparator)}},a.options.place,d);d.done=d.ready.done;d.fail=d.ready.fail;d.always=d.ready.always;d.files=function(a){if(!c.isEmptyObject(a)){if("string"===typeof a)try{a=c.parseJSON(a)}catch(d){}return"object"===typeof a?
a:void 0}}(d.files);d.files&&d.tasks.add(function(){a.importMeta(d.files);d.ready.resolve(d)});d.populate=function(){if(void 0!==d.populate.task)return d.populate.task;d.populate.task=c.Deferred();d.populate[/easysocial|jomsocial|flickr/.test(d.id)||d.files?"getFileTree":"getFolderTree"]();return d.populate.task};d.populate.getFolderTree=function(){return a.getRemoteMeta({place:d.id,foldersOnly:1}).done(function(b){d.tasks.add(function(){a.importMeta(b);d.ready.resolve(d)});d.populate.getFileTree()}).fail(function(){d.populate.task.reject(d);
delete d.populate.task;d.ready.reject(d)})};d.populate.getFileTree=function(){return a.getRemoteMeta({place:d.id}).done(function(b){d.tasks.add(function(){a.importMeta(b);d.ready.resolve(d);d.populate.task.resolve(d)})}).fail(function(){d.populate.task.reject(d);delete d.populate.task})};d.populateImmediately&&d.populate();return d},meta:{},metadata:{},isMeta:function(a){return!(void 0===a||!c.isPlainObject(a)||c.isEmptyObject(a))},get:function(d){if(a.meta.hasOwnProperty(d)){var b=c.extend({},a.meta[d]);
b.data=a.metadata[d];return b}},getKey:function(a){return a?a.place+"|"+a.path:null},getParentKey:function(d){if(d){d="string"===typeof d?d:d.key||a.getKey(d);var b=d.indexOf(e),c=d.lastIndexOf(e);return c===d.length-1?void 0:d.substring(0,c+(b===c?1:0))}},getMeta:function(d){if(d){if(a.isMeta(d))return a.get(a.getKey(d))||d;if("string"===typeof d)return a.get(d)}},getRemoteMeta:function(d){var b=c.Deferred();b.retry=0;d=c.extend({path:a.media.options.directorySeparator,retry:3,retryAfter:1E3,variation:0,
foldersOnly:0},d);if(void 0===d.place)return b.rejectWith(b,"Error: Place not given!");var e=function(){b.loader=EasyBlog.ajax("site.views.media.getMeta",d,{success:function(a){b.resolveWith(b,arguments)},fail:function(){b.rejectWith(b,arguments)},error:function(){b.retry++;b.retry<d.retry?e():b.rejectWith(b,arguments)}});return arguments.callee}();return b},getMetaVariations:function(d){d=a.getMeta(d);if(void 0!==d)return a.getRemoteMeta({place:d.place,path:d.path,variation:1}).done(function(d){a.addMeta(d)})},
removeMetaVariation:function(d,b){d=a.getMeta(d);if(void 0!==d&&void 0!==d.variations){for(var c,e=0;e<d.variations.length;e++)if(d.variations[e].name===b){c=d.variations[e];d.variations.splice(e,1);break}return c}},addMeta:function(d){var b=a.getKey(d),f=a.getMeta(b);if(f&&d.hash===f.hash)return f;d.key=b;d.hash=c.uid();d.group="folder"==d.type?"folders":"files";d.parentKey=a.getParentKey(d);var h=a.getPlace(d.place);d.friendlyPath=d.path===e?h.title:h.title+d.path.substring(d.path.indexOf(e),d.path.length);
a.meta[b]=d;b=d.data=a.metadata[b]||(a.metadata[b]=c.eventable({}));"folder"==d.type&&(b.files=b.files||{},b.folders=b.folders||{},b.views=b.views||a.createMetaView(d));f?setTimeout(function(){d.data.fire("updated",d)},0):(f=a.getMeta(d.parentKey))&&f.data.views.addMeta(d);return d},removeMeta:function(d){d=a.getMeta(d);if(void 0!==d){if("folder"===d.type){var b=d.data.folders,c=d.data.files;for(key in b)a.removeMeta(key);for(key in c)a.removeMeta(key)}d.parentKey&&((b=a.getMeta(d.parentKey))&&b.data.views.removeMeta(d),
delete a.meta[d.key],setTimeout(function(){d.data.fire("removed",d)},0));return d}},removeRemoteMeta:function(d){var b=c.Deferred();d=a.getMeta(d);if(void 0===d)return b.rejectWith(b,"The file does not exist in the media library.");b.loader=EasyBlog.ajax("site.views.media.delete",{place:d.place,path:d.path},{success:function(){a.removeMeta(d);b.resolveWith(b,[d])},fail:function(){b.rejectWith(b,arguments)},error:function(a,d){b.rejectWith(b,[d])}});return b},createFolder:function(d,b){var f=c.Deferred();
d=a.getMeta(d);var h=d.place;if(void 0===d||"folder"!==d.type)return f.rejectWith(f,"Parent folder was not found.");f.loader=EasyBlog.ajax("site.views.media.createFolder",{place:h,path:d.path+e+b},{success:function(d){d.place=h;d=a.addMeta(d);f.resolveWith(f,[d])},fail:function(){f.rejectWith(f,arguments)},error:function(a,d){f.rejectWith(f,[d])}});return f},importMeta:function(d,b){if(void 0!==d&&"folder"===d.type){void 0===b&&(b=!0);var c=d.contents,e=c.length;delete d.contents;c.reverse();for(var f=
a.addMeta(d),h=f.data,r={files:{},folders:{}},t=0;t<e;){d=a.addMeta(c[t]);var s=d.key,v=d.group;r[v][s]=delete h[v][s];t++}for(s in h.files)a.removeMeta(s);for(s in h.folders)a.removeMeta(s);h.folders=r.folders;h.files=r.files;if(b)for(s in h.folders)a.importMeta(a.getMeta(s),b);return f}},createMetaView:function(d){var b={meta:d,addMeta:function(a){for(mode in b.modes){var d=b.modes[mode][a.group];d&&d.add(a)}},removeMeta:function(a){for(mode in b.modes){var d=b.modes[mode][a.group];d&&d.remove(a)}},
create:function(a){var d=c.Callbacks("unique memory");c.extend(d,{from:0,to:1024,mode:"dateModified",group:"files"},a,{uid:c.uid(),select:function(a){c.extend(d,a);d.map&&delete d.map.monitors[d.uid];d.map=b.modes[d.mode][d.group];d.map.monitors[d.uid]=d;return d.refresh()},updated:d.add,refresh:function(){return d.fire(d.map.slice(d.from,d.to))},destroy:function(){d.disable();d.map&&delete d.map.monitors[d.uid];return d}});return d.select()}};a.createViewModes(b);return b},createViewModes:function(d){d.modes=
{dateModified:{folders:a.createViewMap(d,!0),files:a.createViewMap(d)}};return d},createViewMap:function(a,b){var g=c.extend([],{task:c.Threads({threadLimit:1}),affectedIndex:[],add:function(a){g.task.add(function(){g.unshift(a.key);g.affectedIndex.push(0);b&&g.sort().reverse();g.refreshMonitor()})},remove:function(a){g.task.add(function(){for(var d=a.key,b=g.length,c;b--;)if(g[b]===d){c=b;break}void 0!==c&&(g.splice(b,1),g.affectedIndex.push(b),g.refreshMonitor())})},monitors:{},refreshMonitor:function(){clearTimeout(g.refreshMonitor.timer);
g.refreshMonitor.timer=setTimeout(function(){var a=g.affectedIndex;g.affectedIndex=[];g.task.add(function(){var d=a.length,b=0;for(id in g.monitors)for(var c=g.monitors[id],e=c.from,l=c.to,b=0;b<d;b++){var f=a[b];if(f>=e||f<=l){c.refresh();break}}})},250)}});return g},search:function(d){if(""===c.trim(d))return[];d=d.toLowerCase();var b=a.createMetaView({type:"search"});for(key in a.meta){var e=key.split("|"),f=e[1],h=a.meta[key];/easysocial|jomsocial|flickr/.test(e[0])&&(f=h.title||"");f.toLowerCase().match(d)&&
b.addMeta(h)}return b}}});EasyBlog.Controller("Media.Exporter",{defaultOptions:{view:{recentItem:"media/recent.item"},"{recentActivities}":".recentActivities","{recentActivitiesDialog}":".recentActivities .modalPromptDialog","{hideRecentActivitiesButton}":".recentActivities .promptHideButton","{dashboardButton}":".recentActivities .dashboardButton","{recentItemGroup}":".recentItemGroup","{recentItem}":".recentItem"}},function(a){return{init:function(){b.exporter=a;b.insert=a.insert},handler:{},showDialog:function(){a.recentActivitiesDialog().addClass("active");
a.recentActivities().css({top:0,opacity:1}).addClass("active")},hideDialog:function(){a.recentActivities().animate({top:"-=50px",opacity:0},{duration:250,complete:function(){a.recentActivities().removeClass("active");a.recentActivitiesDialog().removeClass("active")}})},"{dashboardButton} click":function(){a.hideDialog()},"{hideRecentActivitiesButton} click":function(){a.hideDialog()},insert:function(d,e){var f=b.library.getMeta(d);if(void 0!==f){var h=a.create(f.type,f.key,e);a.showDialog();h.recentItem=
a.view.recentItem({meta:f}).addClass("loading").css({opacity:0}).prependTo(a.recentItemGroup()).animate({opacity:1},{duration:500,complete:function(){h.done(function(d){""===d&&h.recentItem.removeClass("loading done").addClass("error").find(".itemProgress").html(c.language("COM_EASYBLOG_MM_UNABLE_TO_EXPORT_ITEM"));if("undefined"!=typeof tinyMCE)if(tinyMCE&&tinyMCE.isIE&&9==b.IE){var e=b.bookmark;if(e){var f=tinyMCE.editors.write_content;f.selection.moveToBookmark({rng:e.range});f.execCommand("mceInsertContent",
!1,d)}else EasyBlog.dashboard.editor.insert(d)}else EasyBlog.dashboard.editor.insert(d);else EasyBlog.dashboard.editor.insert(d);h.recentItem.removeClass("loading failed").addClass("done").find(".itemProgress").html(c.language("COM_EASYBLOG_MM_ITEM_INSERTED"));0<b.options.recentActivities.hideAfter&&setTimeout(function(){a.hideDialog()},b.options.recentActivities.hideAfter)}).progress(function(a){h.recentItem.hasClass("done")||h.recentItem.find(".itemProgress").html(a)}).fail(function(a){h.recentItem.removeClass("loading done").addClass("error").find(".itemProgress").html(a)})}});
return h}},create:function(d,b,e){var f=a.handler[d],h=c.Deferred();if(void 0===f){f=EasyBlog.Controller.Media.Exporter[c.String.capitalize(d)];if(void 0===f)return h.reject(c.language("COM_EASYBLOG_MM_UNABLE_TO_FIND_EXPORTER")),h;f=a.handler[d]=new f(a.element,c.extend({},{settings:a.options[d],controller:{media:a.media}}))}f.create(h,b,e);return h}}});EasyBlog.Controller("Media.Exporter.File",{defaultOptions:{settings:{title:"",target:"_self",content:""}}},function(a){return{init:function(){},create:function(d,
b,f){f=c.extend({},a.options.settings,f);b=a.media.library.getMeta(b);b=c(document.createElement("A")).attr({title:f.title,target:f.target,href:b.url}).html(f.content?f.content:b.title);d.resolve(b.toHTML());return d}}});EasyBlog.Controller("Media.Exporter.Folder",{defaultOptions:{settings:{}}},function(a){return{init:function(){},create:function(d,b,f){f=c.extend({},a.options.settings,f);b=a.media.library.getMeta(b);var e="jomsocial"==b.place||"easysocial"==b.place?"album":"gallery";f.file=b.path;
f.place=b.place;f="[embed="+e+"]"+JSON.stringify(f)+"[/embed]";d.resolve(f);return d}}});EasyBlog.Controller("Media.Exporter.Image",{defaultOptions:{settings:{zoom:null,caption:null,lightbox:!1,enforceDimension:!1,enforceWidth:null,enforceHeight:null,variation:null,defaultVariation:"thumbnail",defaultZoom:"original"}}},function(b){return{init:function(){},create:function(d,f,e){var h=c.extend({},b.options.settings,e),k=b.media.library.getMeta(f),p=c(new Image);e=a(k.title);p.attr({src:k.thumbnail.url,
alt:e,title:e});var r=function(){var b={};c.each(k.variations,function(a,d){b[d.name]=d});var f=b[h.variation]||b[h.defaultVariation]||k.variations[0],g=a(f.title);p.attr({src:f.url,alt:g,title:g});h.enforceDimension&&null!==h.enforceWidth&&null!==h.enforceHeight&&(g=c.Image.resizeWithin(f.width,f.height,h.enforceWidth,h.enforceHeight),g.width=Math.floor(g.width),g.height=Math.floor(g.height),p.attr(g));null!==h.caption&&(g=a(h.caption),p.addClass("easyblog-image-caption").attr("title",g));null!==
h.zoom&&(f=b[h.zoom]||b[h.defaultZoom]||{url:k.thumbnail.url,title:k.title},g=a(h.caption||f.title||""),p=c("<a>").addClass("easyblog-thumb-preview").attr({href:f.url,title:g}).html(p));d.resolve(p.toHTML())};h.variation||h.zoom||h.enforceWidth||h.enforceHeight?void 0===k.variations?(d.notify(c.language("COM_EASYBLOG_MM_GETTING_IMAGE_SIZES")),b.media.library.getMetaVariations(f).done(function(a){k=a;r()}).fail(function(){d.reject(c.language("COM_EASYBLOG_MM_UNABLE_TO_RETRIEVE_VARIATIONS"))})):r():
d.resolve(p.toHTML());return d}}});EasyBlog.Controller("Media.Exporter.Audio",{defaultOptions:{width:400,height:24,autostart:!1,controlbar:"bottom",backcolor:"#333333",frontcolor:"#ffffff"}},function(a){return{init:function(){},create:function(d,b,f){f=c.extend({},a.options.settings,f);b=a.media.library.getMeta(b);f.file=b.path;f.place=b.place;b="[embed=audio]"+JSON.stringify(f)+"[/embed]";d.resolve(b);return d}}});EasyBlog.Controller("Media.Exporter.Video",{defaultOptions:{settings:{width:400,height:225,
autostart:!1,controlbar:"bottom",backcolor:"#333333",frontcolor:"#ffffff"}}},function(a){return{init:function(){},create:function(d,b,f){f=c.extend({},a.options.settings,f);b=a.media.library.getMeta(b);f.file=b.path;f.place=b.place;b="[embed=video]"+JSON.stringify(f)+"[/embed]";d.resolve(b);return d}}});EasyBlog.Controller("MediaLauncher",{defaultOptions:{"{uploadImageButton}":".uploadImageButton","{chooseImageButton}":".chooseImageButton"}},function(a){return{init:function(){c("#media_manager_button").click(function(){EasyBlog.mediaManager.browse()})},
"{uploadImageButton} click":function(){EasyBlog.mediaManager.upload()},"{chooseImageButton} click":function(){EasyBlog.mediaManager.browse()}}});var f=c(document.createElement("div")).attr("id","EasyBlogMediaManager").appendTo("body");EasyBlog.mediaManager=new EasyBlog.Controller.Media(f)});EasyBlog.module("media/navigation",function(c){var h=this;EasyBlog.require().done(function(){var a,b,e;EasyBlog.Controller("Media.Navigation",{defaultOptions:{view:{item:"media/navigation.item",itemGroup:"media/navigation.itemgroup"},
nestLevel:8,groupCollapseDelay:1E3,canActivate:!0,"{itemGroup}":".navigationItemGroup","{item}":".navigationItem"}},function(f){return{init:function(){a=f.media;b=a.library;e=a.options.directorySeparator;f.element.toggleClass("canActivate",f.options.canActivate)},setPathway:function(a){if(a=b.getMeta(a)){f.currentKey=a.key;var d=b.getPlace(a.place),l=a.path,h="folder"===a.type,n=l.split(e).splice(1),k=f.options.nestLevel,p=n.length-(n.length%k||k),r;f.element.empty().toggleClass("type-folder",h);
f.view.item({title:d.title||e}).addClass("base").data("key",d.id+"|"+e).appendTo(f.element);var t="jomsocial"===d.id;l!==e&&c.each(n,function(c,l){var u=!h&&c==n.length-1,q=e+n.slice(0,c+1).join(e),q=d.id+"|"+q;l=t?b.getMeta(q).title:l;u=f.view.item({title:u?a.title:l}).data("key",q).toggleClass("filename",u);c>=p?u.appendTo(f.element):(0==c%k&&(r=f.view.itemGroup().appendTo(f.element)),u.appendTo(r))})}},"{itemGroup} mouseover":function(a){clearTimeout(a.data("delayCollapse"));a.addClass("expand")},
"{itemGroup} mouseout":function(a){a.data("delayCollapse",setTimeout(function(){a.removeClass("expand")},f.options.groupCollapseDelay))},"{item} click":function(a){f.options.canActivate&&(a=a.data("key"),f.trigger("activate",a))}}});h.resolve()})});EasyBlog.module("media/uploader",function(c){var h=this;EasyBlog.require().library("plupload").done(function(){var a,b,e,f;EasyBlog.Controller("Media.Uploader",{defaultOptions:{view:{uploader:"media/browser.uploader",uploadItem:"media/browser.uploader.item"},
"{modalHeader}":".modalHeader","{modalToolbar}":".modalToolbar","{modalContent}":".modalContent","{modalFooter}":".modalFooter","{modalPrompt}":".modalPrompt","{modalBrowserButton}":".modalButton.browserButton","{modalDashboardButton}":".modalButton.dashboardButton","{uploadButton}":".uploadButton","{uploadNavigation}":".uploadNavigation","{uploadForm}":".uploadForm","{uploadPath}":".uploadPath","{uploadSize}":".uploadSize","{uploadExtensionList}":".uploadExtensionList","{uploadItemGroup}":".uploadItemGroup",
"{uploadItem}":".uploadItem","{uploadDropHint}":".uploadDropHint","{uploadInstructions}":".uploadInstructions","{clearListButton}":".clearListButton"}},function(g){return{init:function(){a=g.media;b=a.library;e=a.uploader=g;f=a.options.directorySeparator;g.element.addClass("uploader").html(g.view.uploader({uploadSize:g.options.settings.max_file_size,uploadExtensionList:g.options.settings.filters[0].extensions.split(",").join(", ")}));g.uploadNavigation().implement(EasyBlog.Controller.Media.Navigation,
{controller:g.controllerProps()},function(){g.navigation=this});g.modalPrompt().implement(EasyBlog.Controller.Media.Prompt,{controller:g.controllerProps()},function(){g.promptDialog=this});g.element.implement(EasyBlog.Controller.Media.Uploader.FolderSwitcher,{controller:g.controllerProps()},function(){g.folderSwitcher=this});g.element.implement("plupload",{settings:g.options.settings,"{uploadButton}":g.options["{uploadButton}"],"{uploadDropsite}":g.options["{uploadItemGroup}"]},function(){g.plupload=
this.plupload;if("html4"==g.plupload.runtime||c.browser.msie){g.uploadDropHint().remove();g.uploadItemGroup().addClass("indefinite-progress");var d=g.uploadInstructions().appendTo(a.element);g.element.find("> form").mouseover(function(){var b=g.uploadButton(),f=b.offset();d.addClass("show").css({top:f.top+b.outerHeight()-a.element.offset().top+3,right:c(window).width()-(f.left+b.outerWidth())-1})}).mouseout(function(){d.removeClass("show")})}else g.uploadButton().mouseover(function(){g.uploadInstructions().addClass("show")}).mouseout(function(){g.uploadInstructions().removeClass("show")})});
g.setLayout()},setLayout:function(){if("uploader"===a.currentModal){var d;g.modalContent().hide().height(d=g.element.height()-g.modalHeader().outerHeight()-g.modalToolbar().outerHeight()-g.modalFooter().outerHeight()).show();c.browser.msie&&(g.uploadDropHint().height(d),g.uploadItemGroup().height(d));g.plupload&&g.plupload.refresh()}},controllerProps:function(a){return c.extend({media:g.media,uploader:g},a||{})},setUploadFolder:function(a){a&&(g.navigation.setPathway(a),g.currentUploadFolder=a)},
items:{},createItem:function(a){var b=new EasyBlog.Controller.Media.Uploader.Item(g.view.uploadItem(),{controller:g.controllerProps({id:a.id,originalFile:a,uploadFolder:g.currentUploadFolder})});b.element.appendTo(g.uploadItemGroup());var f=b.file().filesize,f=f?"":" ("+f+").";b.setMessage(c.language("COM_EASYBLOG_MM_UPLOADING_PENDING")+f);return g.items[a.id]=b},"{self} BeforeUpload":function(a,f,e,h){h=g.items[h.id];if(void 0!==h){h.setMessage(c.language("COM_EASYBLOG_MM_UPLOAD_PREPARING"));a=g.options.settings.url;
var k=b.getMeta(h.uploadFolder);f=k?k.place:h.uploadFolder.split("|")[0];h=encodeURIComponent(k?k.path:h.uploadFolder.split("|")[1]);e.settings.url=a+"&place="+f+"&path="+h}},"{self} FilesAdded":function(a,b,f,e){try{c.each(e,function(a,b){void 0===g.items[b.id]&&g.createItem(b)}),0<g.uploadItem().length&&g.uploadItemGroup().removeClass("empty"),g.plupload.start()}catch(h){console.error(h)}},"{self} UploadFile":function(a,b,f,e){a=g.items[e.id];void 0!==a&&(a.setState("uploading"),a.setMessage(c.language("COM_EASYBLOG_MM_UPLOADING_STATE")))},
"{self} UploadProgress":function(a,b,f,e){a=g.items[e.id];void 0!==a&&(a.setProgress(e.percent),a.setMessage(c.language("COM_EASYBLOG_MM_UPLOADING")+(void 0!==e.percent?" "+e.percent+"%":"")+(void 0!==e.loaded&&void 0!==!e.size?e.size-e.loaded?" ("+c.plupload.formatSize(e.size-e.loaded)+" "+c.language("COM_EASYBLOG_MM_UPLOADING_LEFT")+")":"":"")))},"{self} FileUploaded":function(b,f,e,h,k){b=g.items[h.id];void 0!==b&&(b.response=k,c.isPlainObject(k)?c.isPlainObject(k.item)?(b.setState("done"),b.setMessage(c.language("COM_EASYBLOG_MM_UPLOAD_COMPLETE")),
b.meta=k.item,b.meta.place=a.library.get(b.uploadFolder).place,"image"!==b.meta.type&&b.insertBlogImageButton().remove(),a.library.addMeta(b.meta)):(b.setState("failed"),b.setMessage(k.message||c.language("COM_EASYBLOG_MM_UPLOAD_UNABLE_PARSE_RESPONSE"))):(b.setState("failed"),b.setMessage(c.language("COM_EASYBLOG_MM_SERVER_RETURNED_INVALID_RESPONSE"))))},"{self} FileError":function(a,b,c,f,e){a=g.items[f.id];void 0===a&&(a=g.createItem(f));a.response=e;a.setState("failed");a.setMessage(e.message);
0<g.uploadItem().length&&g.uploadItemGroup().removeClass("empty")},"{self} Error":function(a,b,c,f){f.file&&(a=f.file,b=g.items[a.id],void 0===b&&(b=g.createItem(a)),b.setState("failed"),b.setMessage(f.message));0<g.uploadItem().length&&g.uploadItemGroup().removeClass("empty")},"{modalBrowserButton} click":function(){a.browse()},"{modalDashboardButton} click":function(){a.hide()},"{uploadNavigation} activate":function(a,b,c){g.setUploadFolder(c)},"{self} modalActivate":function(b,c,f){g.setUploadFolder(f);
a.browser&&g.uploadItemGroup().toggleClass("blogimage","blogimage"==a.browser.mode())},removeItem:function(a){var b=g.items[a];void 0!==b&&(g.plupload.removeFile(b.file()),b.element.remove(),delete g.items[a]);1>g.uploadItem().length&&g.uploadItemGroup().addClass("empty")},"{clearListButton} click":function(){for(id in g.items)g.removeItem(id)}}});EasyBlog.Controller("Media.Uploader.Item",{defaultOptions:{"{filename}":".uploadFilename","{progressBar}":".uploadProgressBar progress","{percentage}":".uploadPercentage",
"{status}":".uploadStatus","{removeButton}":".uploadRemoveButton","{insertItemButton}":".insertItemButton","{locateItemButton}":".locateItemButton","{insertBlogImageButton}":".insertBlogImageButton"}},function(f){return{init:function(){var a=f.file();f.filename().html(a.name);f.setState("queued")},file:function(){var a=e.plupload.getFile(f.id)||f.originalFile;a&&(a.filesize=void 0===a.size||"N/A"==a.size?"":c.plupload.formatSize(f.file.size));return a},dblclick:function(b,c){c.shiftKey&&a.console("log",
f)},setProgress:function(a){f.progressBar().attr("value",a);f.percentage().html(a)},setState:function(a){f.element.removeClass("upload-state-"+f.state).addClass("upload-state-"+a);f.state=a},setMessage:function(a){f.status().html(a)},"{removeButton} click":function(a,b){b.stopPropagation();e.removeItem(f.id)},"{insertItemButton} click":function(){a.insert(f.meta)},"{locateItemButton} click":function(){a.browse(f.meta)},"{insertBlogImageButton} click":function(){var d=b.meta[b.getMeta(f.meta).key];
EasyBlog.dashboard.blogImage.setImage(d);a.hide()}}});EasyBlog.Controller("Media.Uploader.FolderSwitcher",{defaultOptions:{view:{treeItemGroup:"media/browser.tree-item-group",treeItem:"media/browser.tree-item"},"{changeUploadFolderButton}":".changeUploadFolderButton","{selectFolderButton}":".selectFolderButton","{treeItemField}":".browserTreeItemField","{treeItemGroup}":".browserTreeItemGroup","{treeItem}":".browserTreeItem"}},function(g){return{init:function(){var b;g.promptDialog=e.promptDialog.get("changeUploadFolderPrompt");
c.each(a.library.places,function(a,c){c.acl.canUploadItem&&(c.uploaderTreeItemGroup=g.view.treeItemGroup().addClass("expanded").appendTo(g.treeItemField()),c.uploaderTreeItem=g.view.treeItem({title:c.title}).addClass("loading").addClass("type-place").data("place",c).appendTo(c.uploaderTreeItemGroup),b||(b=c.id+"|"+f,e.setUploadFolder(b)),c.done(function(){g.createTreeItem(c.baseFolder());c.uploaderTreeItem.removeClass("loading")}))})},treeItems:{},createTreeItem:function(a){a=b.getMeta(a);return g.treeItems[a.key]||
function(){var f=b.getPlace(a.place),e=b.getMeta(a.parentKey),f=g.treeItems[a.key]=(e?g.view.treeItem({title:a.title}).addClass("type-folder").insertAfter(g.treeItems[e.key]):f.uploaderTreeItem).data("key",a.key);a.data.on("removed",function(){g.removeTreeItem(a)});a.data.views.create({group:"folders"}).updated(function(a){c.each(a,function(a,b){g.createTreeItem(b)})});return f}()},removeTreeItem:function(a){a=b.getMeta(a);var c=g.treeItems[a.key];c&&(c.remove(),e.setUploadFolder(a.parentKey))},"{treeItem} click":function(a){g.treeItem().removeClass("active");
a.addClass("active")},"{changeUploadFolderButton} click":function(){(g.treeItems[g.currentUploadFolder]||g.treeItem(":first")).click();g.promptDialog.show()},"{selectFolderButton} click":function(){var a=g.treeItem(".active").data("key");e.setUploadFolder(a);g.promptDialog.hide()}}});h.resolve()})});EasyBlog.module("media/browser",function(c){var h=this;EasyBlog.require().library("image","easing","scrollTo").script("media/browser.item").done(function(){var a,b,e,f,g;EasyBlog.Controller("Media.Browser",
{defaultOptions:{view:{browser:"media/browser",itemGroup:"media/browser.item-group",item:"media/browser.item",treeItemGroup:"media/browser.tree-item-group",treeItem:"media/browser.tree-item",paginationPage:"media/browser.pagination-page"},path:"",items:void 0,mode:"browse",layout:{viewMode:"tile",tileSize:0.125,scrollToItemDuration:500,scrollToItemEasing:"swing",iconMaxLoadThread:8},search:{chunkSize:128,chunkDelay:500},"{modalHeader}":".modalHeader","{modalToolbar}":".modalToolbar","{modalContent}":".modalContent",
"{modalFooter}":".modalFooter","{modalPrompt}":".modalPrompt","{modalUploaderButton}":".uploaderButton","{header}":".browserHeader","{content}":".browserContent","{footer}":".browserFooter","{treeToggleButton}":".browserTreeToggleButton","{tileViewButton}":".browserTileViewButton","{listViewButton}":".browserListViewButton","{itemField}":".browserItemField","{itemGroup}":".browserItemGroup","{item}":".browserItem","{treeItemField}":".browserTreeItemField","{treeItemGroup}":".browserTreeItemGroup",
"{treeItem}":".browserTreeItem","{headerTitle}":".browserTitle","{headerSearch}":".browserSearch","{headerNavigation}":".browserNavigation","{headerUpload}":".browserUploadButton","{footerStatus}":".browserStatus","{footerMessage}":".browserMessage","{itemActionSet}":".browserItemActionSet","{itemFieldHints}":".browserItemField .hints","{browserPagination}":".browserPagination","{currentPage}":".currentPage","{totalPage}":".totalPage","{prevPageButton}":".prevPageButton","{nextPageButton}":".nextPageButton",
"{pageSelection}":".pageSelection","{paginationPage}":".paginationPage","{searchInput}":".searchInput"}},function(d){return{init:function(){a=d.media;b=a.library;e=a.browser=d;g=a.options.directorySeparator;d.iconThread=c.Threads({threadLimit:d.options.layout.iconMaxLoadThread});d.enqueue=c.Enqueue();var l=b.getPlace("flickr");d.element.addClass("browser").html(d.view.browser({canUpload:d.options.acl.canUpload,flickrCallback:l?l.options.callback:"",flickrLogin:l?l.options.login:""}));d.headerNavigation().implement(EasyBlog.Controller.Media.Navigation,
{controller:d.controllerProps()},function(){d.navigation=this});d.modalPrompt().implement(EasyBlog.Controller.Media.Prompt,{controller:d.controllerProps()},function(){f=d.promptDialog=this});d.element.implement(EasyBlog.Controller.Media.Browser.Actions,{controller:d.controllerProps()},function(){d.actions=this});d.search=c.debounce(d._search,500);d.mode("browse");a.element.bind("hideModal",function(){d.mode("browse")});d.viewMode(d.options.layout.viewMode);d.setLayout();d._bind(d.itemField(),"scroll",
c.debounce(d["{itemField} scroll"],250));c.each(b.places,function(a,b){d.createPlace(b)});d.activatePlace(d.options.initialPlace||b.places[0].id).done(d.enqueue(function(a){d.activateItem(a.baseFolder())}))},controllerProps:function(b){return c.extend({media:a},b||{})},items:{},createPlace:function(a){a=b.getPlace(a);a.treeItemGroup=d.view.treeItemGroup().appendTo(d.treeItemField());a.treeItem=d.view.treeItem({title:a.title}).addClass("type-place").data("place",a).appendTo(a.treeItemGroup);a.itemGroup=
d.view.itemGroup().appendTo(d.itemField());return a},activatePlace:function(a){a=b.getPlace(a);if(void 0!==a){d.itemGroup().removeClass("active");a.itemGroup.addClass("active");d.treeItem().removeClass("active");a.treeItem.addClass("active");a.activator||(a.activator=c.Deferred());if("flickr"===a.id&&!a.options.associated)return e.currentFolderStatus("flickr"),a.activator;a.populated||(a.populated=!0,d.currentFolderStatus("loading"),(/easysocial|jomsocial|flickr/.test(a.id)?a.populate():a.ready).done(function(){var b=
d.createFolder(a.baseFolder());a.activator.resolveWith(a,[a,b])}).fail(function(){d.currentFolderStatus("error");a.activator.rejectWith(a,arguments)}));return a.activator}},getItem:function(a){if(void 0!==a){if(a instanceof EasyBlog.Controller.Media.Browser.Item)return a;if("string"===typeof a)return d.items[a];if(b.isMeta(a))return d.items[b.getKey(a)]}},createItem:function(c,f){if(c=b.getMeta(c))return d.items[c.key]=new EasyBlog.Controller.Media.Browser.Item(d.view.item({meta:c}),{controller:{key:c.key,
media:a}})},createFolder:function(a,f){a=b.getMeta(a);return d.getItem(a)||function(){var b=d.createItem(a),f=b.place(),e=b.parentFolder();e?b.element.insertAfter(e.element):b.element.appendTo(f.itemGroup);b.treeItem=(e?d.view.treeItem({title:a.title}).addClass("type-folder").css("marginLeft",18*(a.path.split(g).length-1)).insertAfter(e.treeItem):f.treeItem).data("item",b);a.data.views.create({group:"folders"}).updated(function(a){c.each(a,function(a,b){d.createFolder(b)})});return b}()},createFile:function(a,
c){a=b.getMeta(a);return d.getItem(a)||d.createItem(a)},removeItem:function(a){clearTimeout(d.removeItem.revert);a=d.getItem(a);var b=a.parentFolder();a.remove();a.treeItem&&a.treeItem.remove();delete d.items[a.key];d.itemField().hasClass("searching")||(d.removeItem.revert=setTimeout(function(){b&&d.activateItem(b)},500))},focusItem:function(a,b){if(a=d.getItem(a))b?d.activateItem(a):(d.currentItem(a),a.element.removeClass("active")),d.scrollTo(a),d.trigger("itemFocus",[a])},locateItem:function(a){d.itemField().hasClass("searching")&&
d.clearSearch(!0);(a=b.getMeta(a))&&d.activatePlace(a.place).done(d.enqueue(function(){var b="folder"===a.type,c=d.activateItem(b?a:a.parentKey);void 0!==c&&(b||c.handler.locateItem(a),(b=c.handler.folderView)&&b.refresh())}))},activateItem:function(a){if(a=d.getItem(a))return d.currentItem(a),a.activate(),d.trigger("itemActivate",[a]),a},scrollTo:function(a){(a=d.getItem(a))&&d.itemField().scrollTo(a.element,{duration:d.options.layout.scrollToItemDuration,easing:d.options.layout.scrollToItemEasing,
offset:{top:-0.1*d.itemField().height()}})},currentItem:function(a){var b=d.currentItem.item;b&&b._destroyed&&(b=d.currentItem.item=void 0);a=d.getItem(a);if(!a||a._destroyed)return b;b&&(b.element.removeClass("active focus"),"folder"!==b.meta().type&&b.parentFolder().element.removeClass("active focus"),b.place().itemGroup.removeClass("active"));a.element.addClass("active focus");(b="folder"==a.meta().type)||a.parentFolder().element.addClass("focus");a.place().itemGroup.addClass("active");d.currentFolder(b?
a:a.parentFolder());d.navigation.setPathway(a.key);return d.currentItem.item=a},currentFolder:function(a){var b=d.currentFolder.folder;b&&b._destroyed&&(b=d.currentFolder.folder=void 0);a=d.getItem(a);if(!a)return b;d.treeItem().removeClass("active");a.treeItem.addClass("active");a.meta().path!==g&&a.place().treeItemGroup.addClass("expanded");a.handler.folderView&&a.handler.refreshSeed!==d.folderRefreshSeed&&(a.handler.folderView.refresh(),a.handler.refreshSeed=d.folderRefreshSeed);return d.currentFolder.folder=
a},currentFolderStatus:function(a){if(!d.itemField().hasClass("searching")||/emptySearch|ready/.test(a)){var b=d.currentFolderStatus.lastStatus;if(void 0===a)return b;if("string"===typeof a)return b&&d.itemField().removeClass(b),d.itemField().addClass(a),d.currentFolderStatus.lastStatus=a}},setLayout:function(){if(a.layout&&"browser"===a.currentModal){var b;d.modalContent().hide().height(b=d.element.height()-d.modalHeader().outerHeight()-d.modalToolbar().outerHeight()-d.modalFooter().outerHeight()).show();
c.browser.msie&&(d.treeItemField().height(b),d.itemField().height(b),d.itemFieldHints().height(b));d.setItemLayout();d.trigger("setLayout")}},setItemStyle:function(b){if(!b){b=a.layout;if(d.setItemStyle.seed===b)return;d.setItemStyle.seed=b}b={};if("tile"==d.viewMode()){var f=function(){var a=c(document.createElement("DIV")).prependTo(d.itemField()),b=a.width();a.remove();return b}(),f=Math.floor(f*d.options.layout.tileSize);b["#EasyBlogMediaManager .browser .browserItemField.view-tile .browserItem"]=
{width:f+"px",height:f-24+"px"}}f=document.getElementsByTagName("head")[0];if(d.itemStyle)try{f.removeChild(d.itemStyle)}catch(e){}d.itemStyle=document.createElement("style");d.itemStyle.type="text/css";var g="";c.each(b,function(a,b){g+=a+"{"+c.map(b,function(a,b){return b+":"+a}).join(";")+"}\n"});d.itemStyle.styleSheet?d.itemStyle.styleSheet.cssText=g:d.itemStyle.appendChild(document.createTextNode(g));f.appendChild(d.itemStyle)},setItemLayout:function(){a.layout&&"browser"===a.currentModal&&(d.setItemStyle(),
setTimeout(function(){var a=[];if(d.itemField().hasClass("searching"))d.searchItemGroup&&(a=d.searchItemGroup.find(".browserItem"));else{var b=d.currentFolder();if(void 0===b)return;a=b.childItem()}if(!(1>a.length)){var c=d.itemField().offset(),f,e,g=a.length,b=1;if(!(1>a.length)){for(;1<Math.abs(g-b);)f=a.eq(b-1),e=f.offset(),0>e.top-c.top+f.outerHeight()?b=Math.ceil((g+b)/2):(g=b,b=Math.ceil(g/2));1===b&&(b=0);var c=b,h=a.length-1;for(setLayout=function(b){if(0>b||b>h)return!1;b=a.eq(b).data("item");
if(!b.isVisible())return!1;b.setLayout()};!1!==setLayout(c);)c--;for(;!1!==setLayout(b);)b++}}},0))},viewMode:function(a){var b=d.viewMode.mode;b||(b=d.viewMode.mode=d.options.layout.viewMode);void 0!==a&&(d.setItemStyle.seed=null,d.itemField().removeClass("view-"+b).addClass("view-"+a),d.viewMode.mode=b=a,d.setLayout(),a=d.currentItem(),void 0!==a&&d.scrollTo(a));return b},mode:function(a){if(void 0===a)return d.mode.currentMode||"browse";switch(a){case "browse":d.element.removeClass("mode-blogimage").addClass("mode-browse");
c.each(b.places,function(a,b){/easysocial|jomsocial|flickr/.test(b.id)&&(b.treeItemGroup&&b.treeItemGroup.show(),b.itemGroup&&b.itemGroup.show())});break;case "blogimage":d.element.addClass("mode-blogimage").removeClass("mode-browse");var f=d.currentItem(),e=!1;f&&/easysocial|jomsocial|flickr/.test(f.place().id)&&(e=!0);c.each(b.places,function(a,b){/easysocial|jomsocial|flickr/.test(b.id)?(b.treeItemGroup&&b.treeItemGroup.hide(),b.itemGroup&&b.itemGroup.hide()):e&&(e=!1,b.treeItem&&b.treeItem.click())})}d.mode.currentMode=
a},"{self} itemActivate":function(a,b,c){d.itemActionSet().removeClass("active");"folder"==c.meta().type?d.itemActionSet(".type-folder").addClass("active"):d.itemActionSet(".type-item").addClass("active")},"{headerNavigation} activate":function(a,b,c){d.activateItem(c)},"{tileViewButton} click":function(a,b){a.addClass("active").siblings().removeClass("active");d.viewMode("tile")},"{listViewButton} click":function(a,b){a.addClass("active").siblings().removeClass("active");d.viewMode("list")},"{treeItem} click":function(a,
b){d.clearSearch(!0);var f=a.data("item");a.hasClass("type-place")?(f=a.data("place"),c(b.target).hasClass("treeItemToggle")&&f.treeItemGroup.toggleClass("expanded"),d.activatePlace(f).done(d.enqueue(function(a,b){"jomsocial"===a.id&&a.treeItemGroup.addClass("expanded");"easysocial"===a.id&&a.treeItemGroup.addClass("expanded");d.activateItem(b)}))):d.activateItem(f)},"{itemField} scroll":function(a,b){d.setItemLayout()},"{item} click":function(a,b){b.stopPropagation();var c=a.data("item");if(void 0!==
c){var f=c.place();d.activatePlace(f).done(d.enqueue(function(a,b){d.activateItem(c)}))}},"{item} dblclick":function(c,f){f.stopPropagation();var e=c.data("item");f.shiftKey?a.console("log",[e]):void 0!==e&&"folder"!=e.meta().type&&("blogimage"===d.mode.currentMode?"image"==e.meta().type&&(EasyBlog.dashboard.blogImage.setImage(b.meta[e.key]),a.hide()):a.edit(e.key))},"{modalUploaderButton} click":function(){var b=d.currentFolder();a.upload(b.place().acl.canUploadItem?b.key:"")},"{self} modalActivate":function(a,
c,f,e){void 0!==e&&d.mode(e);(f=b.getMeta(f)||d.currentItem().meta())&&d.locateItem(f)},"{prevPageButton} click":function(){e.currentFolder().handler.changePage("prev")},"{nextPageButton} click":function(){e.currentFolder().handler.changePage("next")},"{pageSelection} click":function(a){1<d.paginationPage().length&&a.toggleClass("expanded")},"{paginationPage} click":function(a){if(d.pageSelection().hasClass("expanded")&&!a.hasClass("selected")){a=a.data("page");var b=e.currentFolder();b.handler.isChangingPage=
!0;b.handler.currentPage(a)}},"{window} click":function(a,b){var f=c(b.target).attr("class");/pageSelection|paginationPage/.test(f)||d.pageSelection().hasClass("expanded")&&d.pageSelection().removeClass("expanded")},_search:function(a){d.itemBeforeSearch||(d.itemBeforeSearch=d.currentItem().meta());d.element.addClass("searching");d.itemField().addClass("searching");d.searchItemGroup||(d.searchItemGroup=d.view.itemGroup().appendTo(d.itemField()));d.searchItemGroup.addClass("active search-mode");var c;
d.searchView=b.search(a).create({from:0,to:300}).updated(function(a){var b=a.length;if(1>b)c=setTimeout(function(){e.currentFolderStatus("emptySearch")},500);else{clearTimeout(c);e.currentFolderStatus("ready");for(i=0;i<b;i++)e.createFile(a[i]).element.appendTo(d.searchItemGroup);d.setItemLayout()}})},clearSearch:function(a){d.folderRefreshSeed=c.uid();a&&d.searchInput().val("").blur();d.element.removeClass("searching");d.itemField().removeClass("searching");d.searchItems&&c.each(d.searchItems,function(a,
b){c(b).detach()});d.searchItemGroup&&(d.searchItemGroup.find(".browserItem").detach(),d.searchItemGroup.removeClass("active"));d.searchView&&d.searchView.destroy();delete d.searchView;d.itemBeforeSearch&&d.locateItem(d.itemBeforeSearch)},"{searchInput} focusin":function(a){a.parent().addClass("active");""!==c.trim(a.val())&&a.parent().addClass("showCancelButton")},"{searchInput} focusout":function(a){setTimeout(function(){""===c.trim(a.val())&&a.parent().removeClass("active showCancelButton")},50)},
"{searchInput} keyup":function(a){var b=c.trim(a.val());""===b?(a.parent().removeClass("showCancelButton"),d.clearSearch(),delete d.itemBeforeSearch):(a.parent().addClass("showCancelButton"),d.search(b))}}});EasyBlog.Controller("Media.Browser.Actions",{defaultOptions:{"{customizeItemButton}":".customizeItemButton","{insertAsGalleryButton}":".insertAsGalleryButton","{insertItemButton}":".insertItemButton","{insertBlogImageButton}":".insertBlogImageButton","{createFolderButton}":".createFolderButton",
"{confirmCreateFolderButton}":".createFolderPrompt .confirmCreateFolderButton","{folderPath}":".createFolderPrompt .folderPath","{folderCreationPath}":".createFolderPrompt .folderCreationPath","{folderInput}":".createFolderPrompt .folderInput","{folderCreationFailedReason}":".createFolderPrompt .folderCreationFailedReason","{removeItemButton}":".removeItemButton","{removeItemFilename}":".removeItemPrompt .removeItemFilename","{confirmRemoveItemButton}":".confirmRemoveItemButton","{removeItemFailedReason}":".removeItemPrompt .removeItemFailedReason",
"{flickrLoginButton}":".flickrLoginButton","{cancelSearchButton}":".cancelSearchButton","{retryPopulateButton}":".retryPopulateButton"}},function(d){return{init:function(){},"{self} itemActivate":function(a,b,c){d.item=c;a=c.place().acl;d.removeItemButton().toggle(a.canRemoveItem);d.createFolderButton().toggle(a.canCreateFolder);d.insertBlogImageButton().toggle("blogimage"===e.mode()&&"image"===c.meta().type)},"{customizeItemButton} click":function(){a.edit(d.item.key)},"{insertAsGalleryButton} click":function(){a.insert(d.item.key)},
"{insertItemButton} click":function(){a.insert(d.item.key)},"{insertBlogImageButton} click":function(){EasyBlog.dashboard.blogImage.setImage(b.meta[d.item.key]);a.hide()},"{createFolderButton} click":function(){f.get("createFolderPrompt").show().state("default");var a=e.currentFolder();d.folderPath().html(a.meta().friendlyPath);d.folderInput().focus()[0].select()},"{folderInput} keyup":function(a,b){13==b.keyCode&&d.confirmCreateFolderButton().click()},"{confirmCreateFolderButton} click":function(){var a=
c.trim(d.folderInput().val());if(""!==a){var h=e.currentFolder().meta(),n=h.friendlyPath+g+a;d.folderCreationPath().html(n);var k=f.get("createFolderPrompt");k.state("progress");b.createFolder(h,a).done(function(a){a=e.createFolder(a);k.hide();e.activateItem(a)}).fail(function(a){d.folderCreationFailedReason().html(a);k.state("fail")})}},"{removeItemButton} click":function(){d.removeItemFilename().html(d.item.meta().title);f.get("removeItemPrompt").show().state("default")},"{confirmRemoveItemButton} click":function(a){var c=
f.get("removeItemPrompt");c.state("progress");b.removeRemoteMeta(d.item.key).done(function(){c.hide()}).fail(function(a){d.removeItemFailedReason().html(a);c.state("fail")})},"{flickrLoginButton} click":function(a){var c=a.data("login");a=a.data("callback");var d=e.enqueue(function(){e.activatePlace("flickr").done(e.enqueue(function(a,b){e.activateItem(b)}))});window[a]=function(){b.getPlace("flickr").options.associated=!0;d()};window.open(c,"Flickr Login","scrollbars=no, resizable=no, width=650, height=700")},
"{cancelSearchButton} click":function(){e.clearSearch(!0)},"{retryPopulateButton} click":function(){var a=d.item.place();delete a.activator;a.populated=!1;a.treeItem.click()}}});h.resolve()})});EasyBlog.module("media/browser.item",function(c){EasyBlog.Controller("Media.Browser.Item",{defaultOptions:{"{itemTitle}":".itemTitle","{itemIcon}":".itemIcon","{childItem}":".browserItem",hasCustomHandler:["folder"]}},function(h){var a,b,e;return{init:function(){a=h.media;b=a.library;e=a.browser;h.element.data("item",
h).addClass("item-type-"+h.meta().type);h.meta().data.on("removed",function(){e.removeItem(h)});h.createHandler()},meta:function(){return b.getMeta(h.key)},place:function(){return b.getPlace(h.key)},parentFolder:function(){return e.getItem(b.getParentKey(h.key))},createHandler:function(){if(!(0>c.inArray(h.meta().type,h.options.hasCustomHandler))){var a=EasyBlog.Controller.Media.Browser.Item[c.String.capitalize(h.meta().type)];void 0===a?EasyBlog.require().script("media/browser.item."+h.meta().type).done(function(){h.createHandler()}):
h.handler=new a(h.element,{controller:{media:h.media,item:h}})}},activate:function(){h.setLayout();h.handler&&h.handler.activate()},remove:function(){try{h.handler&&(h.handler._destroyed||h.handler.destroy()),h.element&&h.element.remove()}catch(a){}},isVisible:function(){var a=h.element,b=a.outerHeight(),a=a.offset().top,c=a+b,e=h.media.browser.itemField(),m=e.offset().top,e=m+e.height();isVisible=!(a<m&&c<m||a>e&&c>e);h.media.options.debug.itemVisiblity&&h.media.console("info",["Item visibility",
{title:h.meta().title,isVisible:isVisible,item:h,itemHeight:b,itemTop:a,itemBottom:c,itemFieldTop:m,itemFieldBottom:e}]);return isVisible},setLayout:function(a){if("folder"!=h.meta().type){if(h.handler&&c.isFunction(h.handler.setLayout))return h.handler.setLayout();h.setIcon()}},setIcon:function(){h.setIcon.loading||h.setIcon.loaded||void 0===h.meta().icon||h._destroyed||(h.setIcon.loading=!0,e.iconThread.addDeferred(function(a){var b=h.itemIcon();if(h.isVisible()){var c=h.meta(),e=h.place(),m=c.icon.url;
h.setIcon.useNaturalUrl||/easysocial|jomsocial|flickr/.test(e.id)||"image"!==c.type||(m=EasyBlog.baseUrl+"&view=media&layout=getIconImage&place="+encodeURIComponent(e.id)+"&path="+encodeURIComponent(h.meta().path)+"&format=image&tmpl=component");h.element.addClass("loading-icon");b.image("get",m).done(function(){h.element.removeClass("loading-icon");h.setIcon.loaded=!0;h.setIcon.loading=!1;a.resolve()}).fail(function(){h.element.removeClass("loading-icon");h.setIcon.loaded=!1;h.setIcon.loading=!1;
a.reject();h.setIcon.triedNaturalUrl||(h.setIcon.useNaturalUrl=!0,h.setIcon.triedNaturalUrl=!0)})}else h.setIcon.loading=!1,a.reject()}))}}});EasyBlog.Controller("Media.Browser.Item.Folder",{defaultOptions:{"{childItem}":".browserItem"}},function(h){var a,b,e;return{init:function(){a=h.media;b=a.library;e=a.browser;h.element.empty()},items:{},setLayout:function(){var b=h.item.place(),c;switch(b.ready.state()){case "pending":c="loading";break;case "rejected":c="error";break;case "resolved":if(h.folderView&&
0<h.folderView.map.length)c="ready",e.browserPagination().show();else switch(b.populate.task.state()){case "pending":c="loading";break;case "rejected":c="error";break;case "resolved":h.folderView&&1>h.folderView.map.length?(c=b.acl.canUploadItem?"empty canUpload":"empty","jomsocial"===h.item.meta().place&&h.item.meta().path===a.options.directorySeparator&&(c="selectAlbum"),"easysocial"===h.item.meta().place&&h.item.meta().path===a.options.directorySeparator&&(c="selectAlbum")):c="ready",e.browserPagination().toggle(!/empty|selectAlbum/.test(c))}}e.currentFolderStatus(c);
e.setItemLayout();h.isChangingPage?h.isChangingPage=!1:h.populatePages()},populate:function(a){if(!e.itemField().hasClass("searching")){var b,c=a.length,l=h.items;h.items={};if(1>c)try{h.childItem().detach()}catch(m){}else{for(b=0;b<c;b++){var n=a[b],k=e.createFile(n);k.element.appendTo(h.element);h.items[n]=k;delete l[n]}for(n in l)try{l[n].element.detach()}catch(p){}}h.item.place().itemGroup.hasClass("active")&&h.element.hasClass("focus")&&h.setLayout()}},activate:function(){h.folderView||(h.folderView=
h.item.meta().data.views.create({from:0,to:e.options.layout.maxIconPerPage}),h.folderView.updated(h.populate));h.setLayout()},populatePages:function(){var a=h.totalPage();if(2>a)e.browserPagination().hide();else{e.browserPagination().show();e.pageSelection().html("");for(var b=1;b<=a;b++)e.view.paginationPage({page:b}).appendTo(e.pageSelection());h.folderView.currentPage=h.folderView.currentPage||1;e.paginationPage().removeClass("selected");e.paginationPage(".page"+h.folderView.currentPage).addClass("selected")}},
totalPage:function(){var a=h.folderView.map.length,a=Math.floor(0<a%e.options.layout.maxIconPerPage?a/e.options.layout.maxIconPerPage+1:a/e.options.layout.maxIconPerPage);e.totalPage().text()!=a&&e.totalPage().text(a);return a},currentPage:function(a,b){var d=parseInt(h.folderView.currentPage);isNaN(d)&&(d=1,h.folderView.currentPage=1,e.paginationPage().removeClass("selected"),e.paginationPage(":first").addClass("selected"));void 0===a&&(a={from:h.folderView.from});if(c.isPlainObject(a)&&void 0!==
a.from)var l=Math.floor(a.from/e.options.layout.maxIconPerPage)+1;a=l||a;if(a!=d){var l=(a-1)*e.options.layout.maxIconPerPage,m=l+e.options.layout.maxIconPerPage;l!=a.from&&h.folderView.select({from:l,to:m});h.folderView.currentPage=a;e.paginationPage().removeClass("selected");e.paginationPage(".page"+a).addClass("selected");e.trigger("pageChanged",[d,a])}b&&b();return a},next:function(){h.changePage("next")},prev:function(){h.changePage("prev")},changePage:function(a){h.isChangingPage=!0;var b=h.totalPage(),
c=h.currentPage();"next"==a&&c<b&&(c+=1);"prev"==a&&1<c&&(c-=1);h.currentPage(c)},locateItem:function(a){a=b.getMeta(a);var c=h.getItemPage(a);c&&h.currentPage(c,function(){e.focusItem(a.key,!0)})},getItemPage:function(a){a=b.getMeta(a);var g=a.key,d;c.each(h.folderView.map,function(a,b){if(b==g)return d=a,!1});return void 0!==d?Math.floor(d/e.options.layout.maxIconPerPage)+1:!1}}});this.resolve()});EasyBlog.module("media/editor",function(c){var h=this;EasyBlog.require().done(function(){EasyBlog.Controller("Media.Editor",
{defaultOptions:{view:{editor:"media/editor",viewport:"media/editor.viewport"},"{modalHeader}":".modalHeader","{modalToolbar}":".modalToolbar","{modalContent}":".modalContent","{navigationPathway}":".navigationPathway","{insertItemButton}":".insertItemButton","{cancelEditingButton}":".cancelEditingButton"}},function(a){return{init:function(){a.element.addClass("editor").html(a.view.editor());a.navigationPathway().implement(EasyBlog.Controller.Media.Navigation,{controller:{media:a.media},canActivate:!1},
function(){a.navigation=this});a.setLayout()},setLayout:function(){if("editor"===a.media.currentModal){a.modalContent().hide().height(a.element.height()-a.modalHeader().outerHeight()-a.modalToolbar().outerHeight()).show();var b=a.getEditor(a.currentEditor);b&&b.setLayout&&b.setLayout()}},editors:[],handlers:[],loadHandler:function(b){var e=a.handlers[b];if(void 0!==e)return e;e=c.Deferred();e.require=EasyBlog.require().script("media/editor."+b).done(function(){var f=EasyBlog.Controller.Media.Editor[c.String.capitalize(b)];
void 0!==f?e.resolve(f):(delete a.handlers[b],e.reject())}).fail(function(){e.reject()});return e},createEditor:function(b,c){a.removeEditor(b);var f=a.media.library.getMeta(b);void 0!==f&&a.loadHandler(f.type).done(function(g){g=new g(a.view.viewport().addClass("editor-type-"+f.type).prependTo(a.modalContent()),{controller:{media:a.media,editor:a,key:a.media.library.getKey(f)}});a.editors[b]=g;c&&c(g)})},removeEditor:function(b){var c=a.editors[b];void 0!==c&&(c.destroy(),delete a.editors[b])},getEditor:function(b){return a.editors[b]},
activateEditor:function(b){a.deactivateEditor(a.currentEditor);a.navigation.setPathway(b);var c=a.getEditor(b),f=function(c){a.currentEditor=b;c.element.addClass("active");c.activate&&c.activate()};void 0===c?a.createEditor(b,f):f(c)},deactivateEditor:function(){var b=a.getEditor(a.currentEditor);void 0!==b&&(b.deactivate&&b.deactivate(),b.element.removeClass("active"))},"{self} modalActivate":function(b,c,f){a.activateEditor(f)},"{self} modalDeactivate":function(){a.deactivateEditor()},"{insertItemButton} click":function(){var b=
a.getEditor(a.currentEditor);void 0!==b&&b.trigger("insertItem")},"{cancelEditingButton} click":function(){var b=a.getEditor(a.currentEditor);b&&b.trigger("cancelItem");a.media.browse()}}});EasyBlog.Controller("Media.Editor.Panel",{defaultOptions:{"{sectionHeader}":".panelSectionHeader","{sectionContent}":".panelSectionContent"}},function(a){return{init:function(){},"{sectionHeader} click":function(a){a.parent().toggleClass("active")}}});EasyBlog.Controller("Media.Editor.Preview",{defaultOptions:{"{container}":".previewContainer",
"{dialogGroup}":".previewDialogGroup"}},function(a){return{init:function(){},resetLayout:function(){clearTimeout(a.resetLayoutTimer);a.resetLayoutTimer=setTimeout(function(){var b=a.container(),c=a.element.width(),f=a.element.height(),g=b.width(),d=b.height(),h=0,m=0,n="none";g<c?m=(c-g)/2:n="auto";d<f?h=(f-d)/2:n="auto";a.element.css("overflow",n);b.css({top:h,left:m})},100)},showDialog:function(b){a.dialogGroup().addClass("show-dialog-"+b)},hideDialog:function(b){a.dialogGroup().removeClass("show-dialog-"+
b)}}});h.resolve()})});EasyBlog.module("media/constrain",function(c){var h=this;EasyBlog.require().library("image").done(function(){c.fn.constrain=function(){var a=this.data("constrain");if(a instanceof c.Constrain)if(0<arguments.length)a.update(arguments[0]);else return a;else a=new c.Constrain(this,arguments[0]),this.data("constrain",a)};c.Constrain=function(a,b){var e=this;e.options=c.extend(!0,{},{selector:{width:".inputWidth",height:".inputHeight",constrain:".inputConstrain"},forceConstrain:!1},
b?b:{});e.options.element={width:a.find(e.options.selector.width).data("type","width"),height:a.find(e.options.selector.height).data("type","height"),constrain:a.find(e.options.selector.constrain)};e.options.initial=e.options.initial||e.options.source;void 0!==e.options.allowedMax&&(e.options.max=c.Image.resizeWithin(e.options.source.width,e.options.source.height,e.options.allowedMax.width,e.options.allowedMax.height),e.options.initial.width=Math.min(e.options.max.width,e.options.initial.width),e.options.initial.height=
Math.min(e.options.max.height,e.options.initial.height));e.options.element.width.data("initial",e.options.initial.width);e.options.element.height.data("initial",e.options.initial.height);e.fieldValues(e.calculate("width",e.options.initial));c.each([e.options.element.width,e.options.element.height],function(a,b){var d=b.data("type"),h=e.getOppositeType(d);b=c(b);var m=e.options.element[h];b.bind("keyup",function(a){if(9==a.keyCode||16==a.keyCode)return!1;e.fieldValues(e.calculate(d))});b.bind("blur",
function(){e.options.element.constrain.is(":checked")||""!=c.trim(b.val())||b.val(e.options.initial[d]);""==c.trim(b.val())&&""==c.trim(m.val())&&(b.val(e.options.initial[d]),m.val(e.options.initial[h]))})});c(e.options.element.constrain).bind("change",function(){if(c(this).is(":checked")){var a=""===e.fieldValues().width?"height":"width";e.fieldValues(e.calculate(a))}})};c.extend(c.Constrain.prototype,{calculate:function(a,b){b=void 0!==b?b:this.fieldValues();var c=this.getOppositeType(a),f=this.options.max?
this.options.max[a]:void 0,g=this.options.max?this.options.max[c]:void 0,d=this.options.source[a],h=this.options.source[c],m=b[a],n=b[c],m=""!=m&&f&&m>f?f:m;this.enforceConstrain()&&(""==m?n="":(n=Math.round(h/(d/m)),g&&n>g&&(n=g)));f={};f[a]=m;f[c]=n;return f},getOppositeType:function(a){return"width"==a?"height":"width"},getInput:function(a){a=this.options.element[a].val();a=c.trim(a);a=a.replace(/[^0-9.]/g,"");a=parseInt(a,10);return isNaN(a)?"":a},fieldValues:function(a){var b={};void 0===a?(b.width=
this.getInput("width"),b.height=this.getInput("height")):(this.options.element.width.val(Math.floor(a.width)),this.options.element.height.val(Math.floor(a.height)),b=a);return b},enforceConstrain:function(){return this.options.forceConstrain?!0:1>this.options.element.constrain.length?!0:this.options.element.constrain.is(":checked")},update:function(a){this.options.initial=a.initial||a.source||this.options.initial;void 0!==a.allowedMax&&void 0!==a.source&&(a.max=c.Image.resizeWithin(a.source.width,
a.source.height,a.allowedMax.width,a.allowedMax.height),this.options.initial.width=Math.min(a.max.width,this.options.initial.width),this.options.initial.height=Math.min(a.max.height,this.options.initial.height));this.options=c.extend(!0,{},this.options,a);values=this.calculate("width",{width:this.options.initial.width||this.options.source.width,height:this.options.initial.height||this.options.source.height});this.fieldValues(values)}});h.resolve()})});EasyBlog.module("media/editor.audio",function(c){var h=
this;EasyBlog.require().view("media/editor.audio","media/editor.audio.player").done(function(){EasyBlog.Controller("Media.Editor.Audio",{defaultOptions:{view:{panel:"media/editor.audio",player:"media/editor.audio.player"},player:{width:400,height:24,autostart:!1,controlbar:"bottom",backcolor:"#333333",frontcolor:"#ffffff",modes:[{type:"html5"},{type:"flash",src:c.rootPath+"components/com_easyblog/assets/vendors/jwplayer/player.swf"},{type:"download"}]},"{editorPreview}":".editorPreview","{editorPanel}":".editorPanel",
"{playerContainer}":".playerContainer","{autoplay}":".autoplay"}},function(a){var b,e;return{init:function(){b=a.media;e=b.library;var c=a.meta();a.place();a.editorPanel().html(a.view.panel({meta:c})).implement(EasyBlog.Controller.Media.Editor.Panel,{},function(){a.panel=this});a.editorPreview().implement(EasyBlog.Controller.Media.Editor.Preview,{},function(){a.preview=this;a.initPlayer()})},initPlayer:function(){EasyBlog.require().script(c.rootPath+"/components/com_easyblog/assets/vendors/jwplayer/jwplayer.js").done(function(b){var c=
a.meta();a.place();var d="player-"+b.uid();b=b.extend(a.options.player,{id:d,file:a.meta().url});c=a.view.player({id:d,meta:c,options:b});a.preview.container().append(c);a.player=jwplayer(d).setup(b);a.preview.resetLayout()})},meta:function(){return e.getMeta(a.key)},place:function(){return e.getPlace(a.meta().place)},setLayout:function(){},stop:function(){a.player&&"PLAYING"==a.player.getState()&&a.player.pause()},deactivate:function(){a.stop()},"{self} cancelItem":function(){a.stop()},"{self} insertItem":function(){var c=
{autostart:"1"==a.autoplay().val()?!0:!1};b.insert(a.meta(),c)}}});h.resolve()})});EasyBlog.module("media/editor.file",function(c){var h=this;EasyBlog.require().view("media/editor.file","media/editor.file.preview").done(function(){EasyBlog.Controller("Media.Editor.File",{defaultOptions:{view:{panel:"media/editor.file",preview:"media/editor.file.preview"},"{editorPreview}":".editorPreview","{editorPanel}":".editorPanel","{filePreviewCaption}":".filePreviewCaption","{insertItemButton}":".insertItemButton",
"{insertItemDetail}":".insertItemDetail","{insertCaption}":".insertCaption","{insertAs}":".insertAs"}},function(a){var b,c;return{init:function(){b=a.media;c=b.library;var f=a.meta();a.editorPanel().html(a.view.panel({meta:f})).implement(EasyBlog.Controller.Media.Editor.Panel,{},function(){a.panel=this});a.editorPreview().implement(EasyBlog.Controller.Media.Editor.Preview,{},function(){a.preview=this;a.generatePreview()})},generatePreview:function(){var b=a.preview.container().find("a"),c=a.insertAs().val(),
d=a.insertCaption().val();1>b.length?(b=a.meta(),a.preview.container().html(a.view.preview({meta:b,target:c,content:d}))):b.attr("target",c).text(d);a.preview.resetLayout()},setLayout:function(){},meta:function(){return c.getMeta(a.key)},place:function(){return c.getPlace(a.meta().place)},"{self} insertItem":function(){var c={title:a.meta().title,target:a.insertAs().val(),content:a.insertCaption().val()};b.insert(a.meta(),c)},"{insertCaption} keyup":function(b){a.generatePreview()},"{insertCaption} blur":function(b){if(""==
b.val()){var c=a.meta();b.val(c.title);a.generatePreview()}},"{insertAs} change":function(b){a.generatePreview()}}});h.resolve()})});EasyBlog.module("media/editor.image",function(c){var h=this;EasyBlog.require().library("ui/position").script("media/constrain").view("media/editor.image","media/editor.image.variation","media/editor.image.caption").done(function(){EasyBlog.Controller("Media.Editor.Image",{defaultOptions:{view:{panel:"media/editor.image",variation:"media/editor.image.variation",caption:"media/editor.image.caption"},
defaultVariation:"thumbnail","{editorPreview}":".editorPreview","{editorPanel}":".editorPanel","{imageVariationPanel}":".imageVariationPanel","{imageVariationList}":".imageVariationList","{imageVariations}":".imageVariations","{imageVariation}":".imageVariation","{imageEnforceDimensionOption}":".imageEnforceDimensionOption","{imageEnforceWidth}":".imageEnforceWidth","{imageEnforceHeight}":".imageEnforceHeight","{imageCaptionOption}":".imageCaptionOption","{imageCaption}":".imageCaption","{imageZoomOption}":".imageZoomOption",
"{imageZoomLargeImageSelection}":".imageZoomLargeImageSelection","{itemFilesize}":".itemFilesize","{itemFilename}":".itemFilename","{itemUrl}":".itemUrl","{itemCreationDate}":".itemCreationDate","{modalPrompt}":".modalPrompt"}},function(a){var b,e;return{init:function(){b=a.media;e=b.library;var c=a.meta(),g=a.place(),d={controller:{editor:a,media:a.media}};a.editorPanel().html(a.view.panel({meta:c,acl:g.acl,enableLightbox:b.options.exporter.image.lightbox,enforceImageDimension:b.options.exporter.image.enforceDimension,
enforceImageWidth:b.options.exporter.image.enforceWidth,enforceImageHeight:b.options.exporter.image.enforceHeight})).implement(EasyBlog.Controller.Media.Editor.Panel,{},function(){a.panel=this;if("jomsocial"===c.place||"easysocial"==c.place)a.itemFilesize().remove(),a.itemFilename().css("padding-right",0)});a.modalPrompt().implement(EasyBlog.Controller.Media.Prompt,d,function(){a.promptDialog=this});var h=EasyBlog.Controller.Media.Editor.Image.Filter;a.element.implement(h.Dimension,d).implement(h.Caption,
d).implement(h.Lightbox,d);a.editorPreview().implement(EasyBlog.Controller.Media.Editor.Preview,{draggable:!0},function(){a.preview=this;a.previewImage(a.meta().thumbnail.url)});g.acl.canCreateVariation&&g.acl.canDeleteVariation&&a.element.implement(EasyBlog.Controller.Media.Editor.Image.VariationForm,d);a.populateImageVariations();a.setLayout()},meta:function(){return e.getMeta(a.key)},place:function(){return e.getPlace(a.meta().place)},setLayout:function(){a.preview.resetLayout()},"{self} insertItem":function(){var c=
{variation:a.currentImageVariation().data("variation").name};a.imageEnforceDimensionOption().is(":checked")&&(c.enforceDimension=!0,c.enforceWidth=a.imageEnforceWidth().val(),c.enforceHeight=a.imageEnforceHeight().val());a.imageCaptionOption().is(":checked")&&(c.caption=a.imageCaption().val());a.imageZoomOption().is(":checked")&&(c.zoom=a.imageZoomLargeImageSelection().val());b.insert(a.meta(),c)},populateImageVariations:function(){var b=a.meta(),g=b.variations;a.imageVariationsData=a.imageVariationsData||
{};void 0===g?(a.imageVariations().empty().addClass("busy"),e.getMetaVariations(b.key).done(function(){a.populateImageVariations();a.imageVariations().removeClass("busy")}).fail(function(){}).always(function(){a.imageVariations().removeClass("busy")})):(c.each(g,function(b,c){"icon"!=c.name&&a.createImageVariation(c)}),a.trigger("variationPopulated",[a.imageVariationsData]))},createImageVariation:function(b){var c=a.view.variation({variation:b});c.data("variation",b).appendTo(a.imageVariations());
!0!==b["default"]&&"true"!=b["default"]||c.addClass("default");b.canDelete||c.addClass("locked");a.imageVariationsData[b.name]=c;a.trigger("variationCreated",[c,b]);return c},"{self} variationPopulated":function(){var b,e=a.imageVariation(".default");if(0<a.imageVariation().length){if(1>e.length){var e=a.meta(),d=a.previewImage();void 0!==d&&c.each(e.variations,function(a,c){if(c.width==d.width()&&c.height==d.height())return b=c.name,!1});b=b||a.imageVariation(":first").data("variation").name}else b=
e.eq(0).data("variation").name;a.currentImageVariation(b)}},"{imageVariation} click":function(b){b=b.data("variation");a.currentImageVariation(b.name)},currentImageVariation:function(b){var e=a.currentImageVariation.imageVariation;b=a.imageVariationsData[b];if(void 0!==b){var d=b.data("variation"),h=a.meta();if("jomsocial"==h.place||"easysocial"==h.place)h=a.previewImage(),d.width=h?h.data("width"):0,d.height=h?h.data("height"):0,c('<span class="variationDimension"></span>').text(d.width+"x"+d.height).appendTo(b);
e&&e.removeClass("active");b.addClass("active");a.currentImageVariation.imageVariation=b;a.trigger("variationSelected",[b,d])}return a.currentImageVariation.imageVariation},"{self} variationSelected":function(b,c,d,e){a.itemFilesize().html(e.filesize);a.itemUrl().html(e.url);a.itemCreationDate().html(e.dateCreated);a.previewImage(e.url)},"{self} variationRemoved":function(b,c,d,e){delete a.imageVariationsData[e.name];d.remove()},previewImage:function(b){if(void 0===b)return a.previewImage.currentImage;
void 0===a.previewImage.images&&(a.previewImage.images={});var e=a.previewImage.images[b],d=a.previewImage.images[a.previewImage.currentUrl];a.preview.showDialog("loading");void 0===d||c.isDeferred(d)||(d.detach(),a.preview.container().empty());a.previewImage.currentUrl=b;void 0===e?a.previewImage.images[b]=c.Image.get(b).done(function(c){a.previewImage.images[b]=c;a.previewImage.currentUrl==b&&a.previewImage(b)}).fail(function(){a.preview.hideDialog("loading")}):c.isDeferred(e)||(a.preview.container().append(e),
a.previewImage.currentImage=e,a.trigger("previewImage",[a.preview.container(),e]),a.preview.hideDialog("loading"),a.preview.resetLayout())}}});EasyBlog.Controller("Media.Editor.Image.VariationForm",{defaultOptions:{"{imageVariationForm}":".imageVariationForm","{addVariationButton}":".addVariationButton","{createVariationButton}":".createVariationButton","{removeVariationButton}":".removeVariationButton","{cancelVariationButton}":".cancelVariationButton","{tryCreateVariationButton}":".tryCreateVariationButton",
"{newVariationName}":".newVariationName","{newVariationWidth}":".newVariationWidth","{newVariationHeight}":".newVariationHeight","{newVariationRatio}":".newVariationRatio","{newVariationLockRatio}":".newVariationLockRatio","{imageVariationMessage}":".imageVariationMessage",variationNameFilter:/[^a-zA-Z0-9]/g,"{createNewImageVariationPrompt}":".createNewImageVariationPrompt","{promptVariationName}":".createNewImageVariationPrompt .variationName","{promptVariationWidth}":".createNewImageVariationPrompt .variationWidth",
"{promptVariationHeight}":".createNewImageVariationPrompt .variationHeight"}},function(a){return{init:function(){},"{self} variationSelected":function(){var b=a.editor.currentImageVariation().data("variation");a.removeVariationButton().toggle(b.canDelete)},nextVariationName:function(b){var e=!1;b=c.trim(b.toLowerCase());c.each(a.editor.imageVariationsData,function(a,g){if(b==g.data("variation").name.toLowerCase()){e=!0;var d=b.substr(-1,1);b=c.isNumeric(d)?b.substr(0,b.length-1)+(parseInt(d,10)+1):
b+1;return!1}});return e?a.nextVariationName(b):b},"{addVariationButton} click":function(){a.editor.promptDialog.get("createNewImageVariationPrompt").state("default").show();var b=a.editor.currentImageVariation().data("variation");variationName=c.String.capitalize(a.nextVariationName(b.name));a.newVariationName().data("default",variationName).val(variationName).select();a.newVariationWidth().data("default",b.width).val(b.width);a.newVariationHeight().data("default",b.height).val(b.height);a.imageVariationForm().constrain({selector:{width:a.options["{newVariationWidth}"],
height:a.options["{newVariationHeight}"],constrain:a.options["{newVariationLockRatio}"]},source:{width:b.width,height:b.height},allowedMax:{width:a.editor.media.options.exporter.image.maxVariationWidth,height:a.editor.media.options.exporter.image.maxVariationHeight}})},"{newVariationRatio} click":function(b){b.toggleClass("locked");b.hasClass("locked")?a.newVariationLockRatio().attr("checked","checked"):a.newVariationLockRatio().removeAttr("checked");a.newVariationLockRatio().trigger("change")},"{createVariationButton} click":function(){a.createVariation()},
"{tryCreateVariationButton} click":function(){a.createVariation()},"{newVariationName} keyup":function(b,e){var f=c.trim(c(b).val()),f=f.replace(/[^0-9a-zA-Z]/g,"");c(b).val(f);13==e.keyCode&&a.createVariationButton().trigger("click")},"[{newVariationWidth}, {newVariationHeight}] keyup":function(b,c){13==c.keyCode&&a.createVariationButton().trigger("click")},createVariation:function(){var b=a.editor.meta(),e=a.editor.place(),f=a.newVariationName().val(),g=a.newVariationWidth().val(),d=a.newVariationHeight().val();
if(!c.trim(f)||!c.trim(g)||!c.trim(d))return!1;a.promptVariationName().text(f);a.promptVariationWidth().text(g);a.promptVariationHeight().text(d);a.editor.promptDialog.get("createNewImageVariationPrompt").state("progress").show();EasyBlog.ajax("site.views.media.createVariation",{path:b.path,place:e.id,name:f,width:g,height:d},{success:function(c){a.media.library.meta[b.key].variations.push(c);a.editor.createImageVariation(c);a.editor.currentImageVariation(c.name);a.cancelVariationButton().click()},
fail:function(b){a.editor.promptDialog.get("createNewImageVariationPrompt").state("fail").show()}})},"{removeVariationButton} click":function(){var b=a.editor.imageVariation(".active"),c=b.data("variation"),f=a.editor.meta(),g=a.editor.place();c.canDelete&&EasyBlog.ajax("site.views.media.deleteVariation",{fromPath:f.path,place:g.id,name:c.name},{beforeSend:function(){b.addClass("busy")},success:function(){b.slideUp(function(){a.trigger("variationRemoved",[b,c])});a.editor.imageVariation(".default").click();
a.media.library.removeMetaVariation(f,c.name)},fail:function(a){try{console.log(a)}catch(b){}},complete:function(){b.removeClass("busy")}})}}});EasyBlog.Controller("Media.Editor.Image.Filter.Caption",{defaultOptions:{view:{caption:"media/editor.image.caption"},"{imageVariation}":".imageVariation","{imageCaptionOption}":".imageCaptionOption","{imageCaption}":".imageCaption"}},function(a){return{init:function(){a.item={meta:a.editor.meta()}},"{imageVariation} click":function(b){a.transform()},"{self} dimensionEnforced":function(){a.transform()},
"{imageCaptionOption} change":function(b,c){c.stopPropagation();b.parent(".field").toggleClass("hide-field-content",!b.is(":checked"));a.transform()},"{imageCaptionOption} mouseup":function(){setTimeout(function(){a.imageCaption().focus()[0].select()},1)},"{imageCaption} blur":function(b){""==c.trim(b.val())&&b.val(a.item.meta.title);a.transform()},"{imageCaption} keyup":function(b,c){a.transform()},transform:function(){var b=a.editor.preview.container(),c=b.find("img"),f=b.find("div.imageCaptionText");
if(a.imageCaptionOption().is(":checked")){var g=a.imageCaption().val();f.remove();b.width(c.width());b.addClass("imageCaptionBorder");b.width(b.width());b.append(a.view.caption({caption:g}))}else b.removeClass("imageCaptionBorder"),f.remove(),b.width("auto");a.editor.preview.resetLayout()}}});EasyBlog.Controller("Media.Editor.Image.Filter.Lightbox",{defaultOptions:{defaultImageZoomVariation:"original","{imageZoomOption}":".imageZoomOption","{imageZoomLargeImageSelection}":".imageZoomLargeImageSelection",
"{imageZoomLargeImageOption}":".imageZoomLargeImageSelection option"}},function(a){return{init:function(){},"{self} variationCreated":function(b,e,f,g){b=c.String.capitalize(g.name);b=c("<option>").val(b).html(b).data("variation",g);g.name==(a.media.options.exporter.image.zoom||a.options.defaultImageZoomVariation)&&b.attr("selected",!0);a.imageZoomLargeImageSelection().append(b)},"{self} variationRemoved":function(b,c,f,g){a.imageZoomLargeImageOption('[value="'+g.name+'"]').remove()},"{imageZoomOption} change":function(a,
c){c.stopPropagation();a.parent(".field").toggleClass("hide-field-content",!a.is(":checked"))},transform:function(){if(a.imageZoomOption().is(":checked")){var b=a.imageZoomLargeImageOption(":selected").data("variation");image=c("<a>").addClass("easyblog-thumb-preview").attr({href:b.url,title:imageCaption||a.item.meta.title}).html(image)}}}});EasyBlog.Controller("Media.Editor.Image.Filter.Dimension",{defaultOptions:{"{imageEnforceDimension}":".imageEnforceDimension","{imageEnforceDimensionOption}":".imageEnforceDimensionOption",
"{imageEnforceWidth}":".imageEnforceWidth","{imageEnforceHeight}":".imageEnforceHeight","{imageEnforceRatio}":".imageEnforceRatio","{imageEnforceLockRatio}":".imageEnforceLockRatio","{imageVariation}":".imageVariation"}},function(a){return{init:function(){var b={selector:{width:a.options["{imageEnforceWidth}"],height:a.options["{imageEnforceHeight}"],constrain:a.options["{imageEnforceLockRatio}"]}};a.editor.element.bind("variationPopulated",function(){a.editor.media.options.exporter.image.enforceDimension&&
a.imageEnforceDimensionOption().attr({checked:"checked",disabled:"disabled"}).parent(".field").removeClass("hide-field-content");a.applyConstrain(b)})},"{imageVariation} click":function(b){a.applyConstrain()},"{imageEnforceDimensionOption} change":function(b,c){c.stopPropagation();b.parent(".field").toggleClass("hide-field-content",!b.is(":checked"));a.transform()},"{imageEnforceRatio} click":function(b){b.toggleClass("locked");b.hasClass("locked")?a.imageEnforceLockRatio().attr("checked","checked"):
a.imageEnforceLockRatio().removeAttr("checked");a.imageEnforceLockRatio().trigger("change");b.hasClass("locked")&&a.transform()},"{self} previewImage":function(){a.transform()},"{imageEnforceWidth} keyup":function(){a.transform()},"{imageEnforceHeight} keyup":function(){a.transform()},"{imageEnforceWidth} blur":function(b){""!=c.trim(b.val())||a.imageEnforceLockRatio().is(":checked")||b.val(b.data("initial"));a.transform()},"{imageEnforceHeight} blur":function(b){""!=c.trim(b.val())||a.imageEnforceLockRatio().is(":checked")||
b.val(b.data("initial"));a.transform()},transform:function(){var b=a.editor.previewImage();if(void 0!==b){var c={};a.imageEnforceDimensionOption().is(":checked")?c={width:a.imageEnforceWidth().val(),height:a.imageEnforceHeight().val()}:(c=a.editor.currentImageVariation(),c=void 0===c?a.editor.meta():c.data("variation"),c={width:c.width,height:c.height});if(b.width()!==c.width||b.height()!==c.height)b.css(c),a.editor.trigger("dimensionEnforced");a.editor.preview.resetLayout()}},applyConstrain:function(b){var e=
void 0===a.editor.currentImageVariation()?a.editor.meta():a.editor.currentImageVariation().data("variation"),e={source:{width:e.width,height:e.height}};a.editor.media.options.exporter.image.enforceDimension&&(e.allowedMax={width:a.editor.media.options.exporter.image.enforceWidth,height:a.editor.media.options.exporter.image.enforceHeight});b=c.extend(!0,{},e,b);a.imageEnforceDimension().constrain(b);a.transform()}}});h.resolve()})});EasyBlog.module("media/editor.video",function(c){var h=this;EasyBlog.require().view("media/editor.video",
"media/editor.video.player").done(function(){EasyBlog.Controller("Media.Editor.Video",{defaultOptions:{view:{panel:"media/editor.video",player:"media/editor.video.player"},player:{width:400,height:225,autostart:!1,controlbar:"bottom",backcolor:"#333333",frontcolor:"#ffffff",modes:[{type:"html5"},{type:"flash",src:c.rootPath+"components/com_easyblog/assets/vendors/jwplayer/player.swf"},{type:"download"}]},"{editorPreview}":".editorPreview","{editorPanel}":".editorPanel","{playerContainer}":".playerContainer",
"{insertWidth}":".insertWidth","{insertHeight}":".insertHeight","{autoplay}":".autoplay"}},function(a){var b,e;return{init:function(){b=a.media;e=b.library;var c=a.meta(),g=b.options.exporter.video.width,d=b.options.exporter.video.height;void 0!==g&&(a.options.player.width=g);void 0!==d&&(a.options.player.height=d);a.editorPanel().html(a.view.panel({meta:c,insertWidth:a.options.player.width,insertHeight:a.options.player.height})).implement(EasyBlog.Controller.Media.Editor.Panel,{},function(){a.panel=
this});a.editorPreview().implement(EasyBlog.Controller.Media.Editor.Preview,{},function(){a.preview=this;a.initPlayer()})},initPlayer:function(){a.preview.showDialog("loading");EasyBlog.require().script(c.rootPath+"/components/com_easyblog/assets/vendors/jwplayer/jwplayer.js").done(function(b){var c=a.meta();a.place();var d="player-"+b.uid();b=b.extend(a.options.player,{id:d,file:a.meta().url});c=a.view.player({id:d,meta:c,options:b});a.preview.container().append(c);a.player=jwplayer(d).setup(b);
a.preview.resetLayout();a.preview.hideDialog("loading")}).fail(function(){})},meta:function(){return e.getMeta(a.key)},place:function(){return e.getPlace(a.meta().place)},setLayout:function(){},"{self} cancelItem":function(){a.player&&"PLAYING"==a.player.getState()&&a.player.pause()},"{self} insertItem":function(){var c={autostart:"1"==a.autoplay().val()?!0:!1,width:parseInt(a.insertWidth().val(),10),height:parseInt(a.insertHeight().val(),10)};b.insert(a.meta(),c)},resize:function(){if(a.player){var b=
parseInt(a.insertWidth().val(),10),c=parseInt(a.insertHeight().val(),10);a.player.resize(b,c);a.preview.resetLayout()}},"{insertWidth} keyup":function(){a.resize()},"{insertHeight} keyup":function(){a.resize()}}});h.resolve()})});EasyBlog.module("media/uploader.item",function(c){EasyBlog.Controller("Media.Browser.Uploader.Item",{defaultOptions:{"{filename}":".uploadFilename","{progressBar}":".uploadProgressBar progress","{percentage}":".uploadPercentage","{status}":".uploadStatus","{removeButton}":".uploadRemoveButton"}},
function(h){return{init:function(){h.element.data("item",h);h.filename().html(h.file.name);h.setState("queued")},getFilesize:function(a,b){return void 0===h.file.size||"N/A"==h.file.size?"":(a?a:"")+c.plupload.formatSize(h.file.size)+(b?b:"")},setProgress:function(a){h.progressBar().attr("value",a);h.percentage().html(a)},setState:function(a){h.element.removeClass("upload-state-"+h.state).addClass("upload-state-"+a);h.state=a},setMessage:function(a){h.status().html(a)},"{removeButton} click":function(a,
b){b.stopPropagation();h.element.slideUp(function(){h.element.remove()})}}});this.resolve()});EasyBlog.module("ratings",function(c){var h=this;EasyBlog.require().library("ui/stars").script("legacy").done(function(){eblog.ratings={setup:function(a,b,e){c("#"+a).stars({split:2,disabled:b,oneVoteOnly:!0,cancelShow:!1,callback:function(b){eblog.loader.loading(a+"-command .rating-text");ejax.load("ratings","vote",b.value(),c("#"+a).children("input:hidden").val(),e,a)}})},showVoters:function(a,b){ejax.load("ratings",
"showvoters",a,b)},update:function(a,b,e,f){c("#"+a).children(".ui-stars-star").removeClass("ui-stars-star-on");e=parseInt(e);c("#"+a+"-command").hide();c("#"+a).addClass("voted");c("#"+a).children(".ui-stars-star").each(function(a){a<e?c(this).addClass("ui-stars-star-on"):c(this).removeClass("ui-stars-star-on")})}};h.resolve()})});EasyBlog.module("tag",function(c){var h=this;EasyBlog.require().view("dashboard/dashboard.tags.item").done(function(){EasyBlog.Controller("Tag.Form",{defaultOptions:{tags:[],
tagLimit:0,tagSelections:[],tagSelectionLimit:25,"{tagList}":".tag-list.creation","{tagItems}":".tag-list.creation .tag-item","{tagItemRemoveButton}":".remove-tag","{tagCreationForm}":".new-tag-item","{tagInput}":".tagInput","{tagCreateButton}":".tag-create","{totalTags}":".total-tags","{tagSelectionFilter}":".tag-selection-filter","{tagSelectionList}":".tag-list.selection","{tagSelectionItems}":".tag-list.selection .tag-item","{tagSelection}":".tag-selection","{showAllTagsButton}":".show-all-tags",
view:{tagItem:"dashboard/dashboard.tags.item"}}},function(a){return{init:function(){EasyBlog.dashboard&&EasyBlog.dashboard.registerPlugin("tags",a);setTimeout(function(){var b=a.options.tagSelections,c,f=b.length;for(c=0;c<f;c++)a.tags[b[c].title.toLowerCase()]=b[c];b=a.options.tags;f=b.length;for(c=0;c<f;c++){var g=a.getKey(b[c].title);a.selectTag(g)}a.showTagSelections("")},0)},tags:{},items:{},selected:{},sanitizeTitle:function(a){return c.trim(a).replace(/[,\'\"\#\<\>]/gi,"")},getKey:function(b){return a.sanitizeTitle(b).toLowerCase()},
getTag:function(b){return Object.prototype.hasOwnProperty.call(a.tags,b)?a.tags[b]:void 0},createTag:function(b){b=a.sanitizeTitle(b);var c=b.toLowerCase();return a.getTag(c)||(a.tags[c]={title:b})},getTagItem:function(b){var c=a.getTag(b);if(c)return c.item||(c.item=a.view.tagItem({title:c.title}).data("key",b))},getTagData:function(b){if(b=a.getTag(b))return b.data||(b.data=c('<input class="tagdata" type="hidden" name="tags[]" value="'+b.title+'" />'))},search:function(b){b=c.trim(b).toLowerCase();
var e=[];for(key in a.tags)0>key.indexOf(b)||e.push(key);return e},selectTag:function(b){clearTimeout(a.selectTag.refreshTagSelection);var c=a.getTagItem(b);if(c){var f=a.tagItems();0<a.options.tagLimit&&f.length>=a.options.tagLimit||(c.css({opacity:0}),1>f.length?a.tagList().prepend(c):(f=f.filter(":last"),f[0]!=c[0]&&c.insertAfter(f)),c.animate({opacity:1}),a.getTagData(b).appendTo(a.element),a.selected[b]=!0,a.checkTagLimit(),a.selectTag.refreshTagSelection=setTimeout(function(){a.showTagSelections()},
500))}},unselectTag:function(b){var c=a.getTagItem(b);c&&(c.detach(),a.getTagData(b).detach(),delete a.selected[b],a.checkTagLimit(),void 0!==a.getTag(b).alias&&a.showTagSelections())},addToTagSelectionList:function(b){return(b=a.getTagItem(b))&&b.appendTo(a.tagSelectionList())},showTagSelections:function(b){a.tagSelectionItems().detach();b=a.currentFilter=void 0===b?a.currentFilter||"":b;var c=0,f=a.options.tagSelectionLimit;if(""===b)for(h in a.tags){if(c>=f)break;a.selected[h]||void 0===a.getTag(h).alias||
(a.addToTagSelectionList(h),c++)}else{b=a.search(b);var g,d=b.length;for(g=0;g<d&&!(c>=f);g++){var h=b[g];a.selected[h]||void 0===a.getTag(h).alias||(a.addToTagSelectionList(h),c++)}}a.tagSelection().toggleClass("no-selection",1>c)},"{tagInput} keydown":function(b,c){c.stopPropagation();a.realEnterKey=13==c.keyCode},"{tagInput} keypress":function(b,c){c.stopPropagation();a.realEnterKey=a.realEnterKey&&13==c.keyCode},"{tagInput} keyup":function(b,c){clearTimeout(a.filterTask);c.stopPropagation();switch(c.keyCode){case 27:b.val("");
break;case 13:a.realEnterKey&&b.hasClass("canCreate")&&a.createTagFromInput()}a.filterTask=setTimeout(function(){a.showTagSelections(b.val())},250)},createTagFromInput:function(){var b=c.trim(a.tagInput().val());if(""!==b){var e=a.getKey(b);a.createTag(b);a.selectTag(e);a.tagInput().val("")}a.showTagSelections("")},checkTagLimit:function(){var b=a.options.tagLimit;if(!(1>b)){var c=a.tagItems().length;a.totalTags().text(c);a.tagCreationForm()[c>=b?"hide":"show"]()}},"{tagCreateButton} click":function(){a.createTagFromInput()},
"{tagSelectionItems} click":function(b){b=b.data("key");a.selectTag(b)},"{tagItemRemoveButton} click":function(b){b=b.parents(".tag-item").data("key");a.unselectTag(b)},"{showAllTagsButton} click":function(b){b.hasClass("active")?(b.removeClass("active"),a.options.tagSelectionLimit=a.originalLimit):(b.addClass("active"),a.originalLimit=a.options.tagSelectionLimit,a.options.tagSelectionLimit=9999);a.showTagSelections("")}}});h.resolve()})})});