<?php/** * @package 	Bookpro * @author 		Nguyen Dinh Cuong * @link 		http://ibookingonline.com * @copyright 	Copyright (C) 2011 - 2012 Nguyen Dinh Cuong * @license 	GNU/GPLv3 http://www.gnu.org/licenses/gpl-3.0.html * @version 	$Id: orders.php 56 2012-07-21 07:53:28Z quannv $ * */defined('_JEXEC') or die('Restricted access');//import needed Joomla! librariesjimport('joomla.application.component.model');//import needed JoomLIB helpersAImporter::helper('bookpro', 'model');//import needed tablesclass BookProModelOrderFlights extends JModelList {public function __construct($config = array())	{		if (empty($config['filter_fields'])) {			$config['filter_fields'] = array(					'l.id',					'l.title',			);		}		parent::__construct($config);	}	protected function populateState($ordering = null, $direction = null)	{		parent::populateState();		$app = JFactory::getApplication();		$id = JRequest::getVar('id', 0, '', 'int');		$this->setState('orderflights.id', $id);					// Load the filter state.		$search = $this->getUserStateFromRequest($this->context . '.filter.search', 'filter_search');		$this->setState('filter.search', $search);									$state = $this->getUserStateFromRequest($this->context . '.filter.state', 'filter_search');		$this->setState('filter.state', $state);						parent::populateState('l.id', 'asc');				}	protected function getListQuery()	{		AImporter::helper('ordertype');		OrderType::init();				$db		= $this->getDbo();		$query	= $db->getQuery(true);		$query->select('l.*,user.name AS username,`c`.`id` AS `cid`');		$query->select('CONCAT(`c`.`firstname`,'.$db->quote(' ').',`c`.`lastname`) AS `ufirstname`');		$query->from('#__bookpro_orders AS l');		$query->join('LEFT', '#__bookpro_customer AS c ON c.id = l.user_id');		$query->join('LEFT', '#__users AS user ON user.id = l.sale_id');		$query->where('l.type='.$db->quote(OrderType::$FLIGHT->getValue()));		return $query;	}}?>